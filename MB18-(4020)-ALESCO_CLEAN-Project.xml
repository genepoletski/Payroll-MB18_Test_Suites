<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="c45866f0-db15-4c46-8d2d-b96193335e8a" created="2.4.0" activeEnvironment="Dev" name="MB18-(4020)-ALESCO_CLEAN-Project" resourceRoot="" updated="2.5.0 2018-09-14T14:45:07Z" encryptionMode="Not encrypted" xmlns:con="http://eviware.com/soapui/config"><con:settings><con:setting id="IncludeOverview">true</con:setting><con:setting id="IncludeResults">true</con:setting><con:setting id="FlowLayout">false</con:setting><con:setting id="ErrorDetails">true</con:setting><con:setting id="IncludeCoverage">true</con:setting><con:setting id="GeneratableJUnitReport@Style">Single Page (Print)</con:setting><con:setting id="GeneratableJUnitReport@Folder"/></con:settings><con:testSuite id="7d964222-f1a6-40fb-b593-2083d9fbf531" name="4020-05_PPM_ALL"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:runType>SEQUENTIAL</con:runType><con:testCase id="dbc271af-be72-4f49-88cb-718afdd841bc" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 1 Csv matches _X tables" searchProperties="true" timeout="0"><con:description>zero rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="70321b91-9030-4e4a-b7d4-8c6767c5fda7"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select x.*, case when abs(rows_diff)+abs(hours_diff)=0 then 'Pass' end test_result from 
(
select 'MB18_PPM_2011_13_CS_X' file_name,
count(*) rows_imported,  521303 expected_row_count,  521303 - count(*) rows_diff
,sum (paid_hours) sum_paid_hours , 3019986.227 expected_sum_paid_hours ,round(sum (paid_hours)-3019986.227,0) hours_diff
from MB18.MB18_PPM_2011_13_CS_X
union all
select 'MB18_PPM_2014_18_CS_X' file_name,
count(*) rows_imported,   806559 expected_row_count,   806559 - count(*) rows_diff
,sum (paid_hours) sum_paid_hours ,  4767271.274 expected_sum_paid_hours ,round(sum (paid_hours)-4767271.274,0) hours_diff
from MB18.MB18_PPM_2014_18_CS_X
union all
select 'MB18_PPM_2011_13_No_X' file_name,
count(*) rows_imported,   562172 expected_row_count,   562172 - count(*) rows_diff
,sum (paid_hours) sum_paid_hours ,  3421947.4 expected_sum_paid_hours ,round(sum (paid_hours)-3421947.44,0) hours_diff
from MB18.MB18_PPM_2011_13_No_X
union all
select 'MB18_PPM_2014_18_No_X' file_name,
count(*) rows_imported,   865661 expected_row_count,   865661 - count(*) rows_diff
,sum (paid_hours) sum_paid_hours ,  5324350.919 expected_sum_paid_hours ,round(sum (paid_hours)-5324350.919,0) hours_diff
from MB18.MB18_PPM_2014_18_No_X
)x</con:query><con:assertion type="GroovyScriptAssertion" id="8c29624e-5cd0-4888-9b48-3234923d48a7" name="Assert node [TEST_RESULT]"><con:configuration><scriptText>import com.eviware.soapui.support.XmlHolder

def holder = new XmlHolder( messageExchange.responseContentAsXml )
def results  = holder.getNodeValues("//TEST_RESULT")

results.each { assert "${it}"  == 'Pass' }</scriptText></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="70c733ce-be62-4e48-9d06-2eaa44803ee8" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 2 Check emplids exist" searchProperties="true" timeout="0"><con:description>zero rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="2b029c1a-848f-4c15-88e1-c057bbff98a1"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from MB18.mb18_ppm_timesheets
where trim(emplid) not in (select employee# from mb18_ods_alesco.employee union all select emplid from mb18_ods_peoplesoft.ps_personal_data)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="95ceecbc-21bc-4f59-8528-015d85c03fc4" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 3 Checking sum of X table matches mb18_ppm_timesheets incl cleaning;" searchProperties="true" timeout="0"><con:description>zero rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="dcfb966c-0c9c-40c5-b6be-70c31d3d1449"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select ENTER_DATE, emplid,day_paid_hours  from MB18.mb18_ppm_timesheets 
--where emplid='0804874'
minus
select ENTER_DATE, 
case 
when trim(EMPLOYEE_ID) ='Beaton' then '1005039' 
when trim(EMPLOYEE_ID) ='4Johnstone' then '1007366' 
when trim(EMPLOYEE_ID) ='FreddieOsborne1' then '1009489' 
when trim(employee_id)='58644824' then '1003254'
when trim(employee_id)='955423' then '1006393'
when trim(employee_id)='805896' then '0805896'
when trim(employee_id)='809982' then '0809982'
when trim(employee_id)='814585' then '0814585'
when trim(employee_id)='081950' then '0819590'
when trim(employee_id)='820422' then '0820422'
when trim(employee_id)='12345611' then '0823677'
when trim(employee_id)='999999' then '0827264'
when trim(employee_id)='829175' then '0829175'
when trim(employee_id)='00830130' then '0830130'
when trim(employee_id)='832902' then '0832902'
when trim(employee_id)='0829623' then '0834237'
when trim(employee_id)='0809752' then '0836093'
when trim(employee_id)='00836404' then '0836404'
when trim(employee_id)='100312' then '1000312'
when trim(employee_id)='789981' then '1000333'
when trim(employee_id)='100645' then '1000645'
when trim(employee_id)='1001082' then '1001704'
when trim(employee_id)='000000' then '1001752'
when trim(employee_id)='12345' then '1002806'
when trim(employee_id)='011111' then '1003472'
when trim(employee_id)='0000012' then '1004733'
when trim(employee_id)='562582' then '1005228'
when trim(employee_id)='1111000' then '1006298'
when trim(employee_id)='13789' then '1007453'
when trim(employee_id)='100000000000' then '1008952'
when trim(employee_id)='369852' then '1009301'
when trim(employee_id)='147852' then '1009353'
when trim(employee_id)='1324692' then '1009945'
else  replace(trim(EMPLOYEE_ID),'.') end EMPLOYEE_ID
,paid_hours
from
(select ENTER_DATE, employee_id,sum(paid_hours)  paid_hours from MB18.MB18_PPM_2011_13_CS_X  group by  ENTER_DATE, employee_id
    union all select ENTER_DATE, employee_id,sum(paid_hours) paid_hours from MB18.MB18_PPM_2014_18_CS_X group by  ENTER_DATE, employee_id 
        union all select ENTER_DATE, employee_id,sum(paid_hours) paid_hours from MB18.MB18_PPM_2011_13_No_X   group by  ENTER_DATE, employee_id
            union all select ENTER_DATE, employee_id,sum(paid_hours) paid_hours from MB18.MB18_PPM_2014_18_No_X group by  ENTER_DATE, employee_id)
where  trim(employee_id) not in ('1004387-1', 'FrancesN','Mar2012','2Mar19','Mar19'  ,'2Thompson', 'Nicole McDonnell' ,'BaeleiAckers1','041001','0000111','00000101','041000')</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="7bb3a4fa-0dba-4e1f-a6b8-f912c37cbc04" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 4 ALESCO_PPM_DAYS_PAID_CLEAN summary is right" searchProperties="true" timeout="0"><con:description>zero rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="41cd0d5f-06ef-4ec6-a60c-d05cdeb527b9"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select emplid, expected_week_end, count(*) from
(select emplid, enter_date, next_day(enter_date,'SUNDAY')-1 expected_week_end from  (select distinct emplid, enter_date from MB18.MB18_PPM_TIMESHEETS where day_paid_hours>0))
--where emplid='0801507'   --and enter_Date between '10-jul-2011' and '16-jul-2011'
group by emplid, expected_week_end

minus

select emplid,  EXPECTED_END_DATE, PPM_DAYS_PAID
from MB18.ALESCO_PPM_DAYS_PAID_CLEAN_RW</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:properties/><con:reportParameters/></con:testSuite><con:testSuite id="74a753a7-b298-497e-a293-55e5234cba49" name="4020-10-ALESCO_PEHISTPAY_CLEAN"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:runType>SEQUENTIAL</con:runType><con:testCase id="6685d8d5-351b-431e-9bef-2333fcc5aadc" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST1 - Only rows with PAYTYPE in ('S','O','A') and ORIGIN &lt;> 'CNV'" searchProperties="true" timeout="0"><con:description>No rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="c2f45106-48ca-4052-b421-895debe2af70"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT count(*) FROM mb18.alesco_pehistpay_clean WHERE paytype NOT IN ('S','O','A') OR origin = 'CNV'</con:query><con:assertion type="GroovyScriptAssertion" id="8c29624e-5cd0-4888-9b48-3234923d48a7" name="Assert node [TEST_RESULT]"><con:configuration><scriptText>import com.eviware.soapui.support.XmlHolder

def holder = new XmlHolder( messageExchange.responseContentAsXml )
def results  = holder.getNodeValues("//TEST_RESULT")

results.each { assert "${it}"  == 'Pass' }</scriptText></con:configuration></con:assertion><con:assertion type="XPath Match" id="768ab7de-c347-4562-8ff6-3f14195fec25" name="Check COUNT of rows in output is 0"><con:configuration><path>//Results[1]/ResultSet[1]/Row[1]/COUNT[1]/text()</path><content>0</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="81c27939-9678-459d-9632-02d62fb5caef" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST2a - Differences between PEHISTPAY with filters and ALESCO_PEHISTPAY_CLEAN" searchProperties="true" timeout="0"><con:description> No rows = Pass;</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="98378ef6-9449-4bd1-b208-a74e6c6ce337"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select count(*) from mb18_ods_alesco.pehistpay
WHERE
paytype in ('S','O','A')
AND origin &lt;> 'CNV'
MINUS
select count(*) from mb18.alesco_pehistpay_clean</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="1b7a42fb-08a1-4bd0-9472-de68f2beda8e" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="Test 2a-1" searchProperties="true" timeout="0"><con:description/><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="2f7a8002-70eb-45ff-b19e-c6164646f297"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select sum(amt), sum(unit) from mb18_ods_alesco.pehistpay
WHERE
paytype in ('S','O','A')
AND origin &lt;> 'CNV'
MINUS
select sum(amt), sum(unit) from mb18.alesco_pehistpay_clean</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="0c8f3766-64f8-471c-be88-9fd4261690d4" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST2b - Differences between PEHISTPAY with filters and ALESCO_PEHISTPAY_CLEAN" searchProperties="true" timeout="0"><con:description>No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="94cb74e0-5a54-4927-8cc3-adc19b2cc661"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select count(*) from mb18.alesco_pehistpay_clean MINUS select count(*) from mb18_ods_alesco.pehistpay WHERE paytype in ('S','O','A') AND origin &lt;> 'CNV'</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="2fed47de-f9df-401f-8005-89253dcd73f4" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST3 - Check all the paycodes are in mb18.PAYCODES_TBL" searchProperties="true" timeout="0"><con:description>No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="b5948591-1180-4d94-94a1-9d459898ec24"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT distinct paycode FROM mb18.alesco_pehistpay_clean WHERE paycode NOT IN (SELECT distinct paycode FROM mb18.paycodes_tbl WHERE source = 'ALESCO')</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:properties/><con:reportParameters/></con:testSuite><con:testSuite id="937e2128-2306-4ca9-9973-6041fc4c56be" name="4020-20 ALESCO_PERSON_CLEAN apr"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:runType>SEQUENTIAL</con:runType><con:testCase id="4c460ea4-51b4-4a93-b0aa-421d866f05a2" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="ALESCO_PERSON_CLEAN apr" searchProperties="true" timeout="0"><con:description>No rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="7fb0f1f3-fd5b-4017-a8ae-9da94ddaaa20"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select a.emplid, a.surname, a.ird_number , a.hire_date, a.termination_date
from MB18.alesco_person_clean a 
where 1=1

minus
select a.employee#, a.surname, a.taxno,  a.FIRST_COMMENCE, b.TERM_DATE
from mb18_ODS_ALESCO.EMPLOYEE a, mb18_ODS_ALESCO.job b
where 1=1
and a.employee#=b.employee#</con:query><con:assertion type="GroovyScriptAssertion" id="8c29624e-5cd0-4888-9b48-3234923d48a7" name="Assert node [TEST_RESULT]"><con:configuration><scriptText>import com.eviware.soapui.support.XmlHolder

def holder = new XmlHolder( messageExchange.responseContentAsXml )
def results  = holder.getNodeValues("//TEST_RESULT")

results.each { assert "${it}"  == 'Pass' }</scriptText></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:properties/><con:reportParameters/></con:testSuite><con:testSuite id="cd700071-2210-40d8-a087-69fb6a1d62c6" name="4020-30 ALESCO_OCCUPANCY_CLEAN including staging tables aoc XXXXX"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:runType>SEQUENTIAL</con:runType><con:testCase id="1406ccf5-1119-49d6-b386-6e6ad9c15c9e" discardOkResults="true" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST1a - All applicable records come from ODS to occupancy1" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>No rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="8eb13343-1cb1-46cd-a99c-cae4e1f215f8"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query><![CDATA[SELECT occ.employee_no, occ.original_employee_no, occ.job_no,
         CASE
            WHEN occ.portion_start <= max_extended_end
               THEN (max_extended_end + 1)
            ELSE portion_start
         END AS portion_start,
         CASE
            WHEN occ.portion_end >
                   (SELECT date_value
                      FROM mb18.constants
                     WHERE NAME =
                              'LAST_DATE_TO_CALC_BACKPAY_FOR_ALESCO')
               THEN (SELECT date_value
                       FROM mb18.constants
                      WHERE NAME =
                               'LAST_DATE_TO_CALC_BACKPAY_FOR_ALESCO')
            ELSE portion_end
         END AS portion_end,
         CASE
            WHEN occ.avg_hours <= 0.7
               THEN 0
            WHEN ROUND ((occ.avg_hours / occ.std_hours_wk), 4) > 1
               THEN 1
            ELSE ROUND ((occ.avg_hours / occ.std_hours_wk), 4)
         END AS fte_raw,
         job.company_code, job.paygrp
    FROM mb18_ods_alesco.ah_occupancy occ,
         mb18_ods_alesco.job job,
         (SELECT   emplid, MAX (extended_effdt_end) max_extended_end
              FROM mb18.employment_history
             WHERE SOURCE = 'PSOFT'
          GROUP BY emplid) hist
   WHERE occ.employee_no = hist.emplid(+)
     AND occ.employee_no = job.employee#
     AND occ.job_no = job.job#
     AND occ.portion_end > NVL (max_extended_end, '23-APR-2011')
     AND occ.position_no <> '1001'
     AND occ.emp_status <> 'N'
     AND job.paygrp <> 'NPAY'
     AND emplid NOT IN
            ('0824301', '0824307') -- these two are okay as per MJ 28-MAR-2014
     AND occ.portion_start <
                        (SELECT date_value
                           FROM mb18.constants
                          WHERE NAME = 'LAST_DATE_TO_CALC_BACKPAY_FOR_ALESCO')
GROUP BY occ.employee_no,
         occ.original_employee_no,
         occ.job_no,
         portion_start,
         occ.portion_end,
         occ.avg_hours,
         occ.std_hours_wk,
         job.company_code,
         job.paygrp,
         max_extended_end
MINUS
SELECT emplid, orig_emplid, job_no, effdt_start, effdt_end, fte, company,
       paygroup
  FROM mb18.alesco_occupancy_clean_1]]></con:query><con:assertion type="GroovyScriptAssertion" id="8c29624e-5cd0-4888-9b48-3234923d48a7" name="Assert node [TEST_RESULT]"><con:configuration><scriptText>import com.eviware.soapui.support.XmlHolder

def holder = new XmlHolder( messageExchange.responseContentAsXml )
def results  = holder.getNodeValues("//TEST_RESULT")

results.each { assert "${it}"  == 'Pass' }</scriptText></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="752572f6-c315-4b0f-a64e-29c29d5b47a8" discardOkResults="true" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST1b - All applicable in occupancy1 come from ODS" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description> No rows = Pass;</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="f17817e1-97be-4188-837e-656baa4b6138"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query><![CDATA[SELECT emplid, orig_emplid, job_no, effdt_start, effdt_end, fte, company,
       paygroup
  FROM mb18.alesco_occupancy_clean_1
--  where emplid='141869' and job_no='01' and effdt_start='3/may/2014'
  
MINUS
SELECT   occ.employee_no, occ.original_employee_no, occ.job_no,
         CASE
            WHEN occ.portion_start <= max_extended_end
               THEN (max_extended_end + 1)
            ELSE portion_start
         END AS portion_start,
         CASE
            WHEN occ.portion_end >
                   (SELECT date_value
                      FROM mb18.constants
                     WHERE NAME =
                              'LAST_DATE_TO_CALC_BACKPAY_FOR_ALESCO')
               THEN (SELECT date_value
                       FROM mb18.constants
                      WHERE NAME =
                               'LAST_DATE_TO_CALC_BACKPAY_FOR_ALESCO')
            ELSE portion_end
         END AS portion_end,
         CASE
            WHEN occ.avg_hours <= 0.7
               THEN 0
            WHEN ROUND ((occ.avg_hours / occ.std_hours_wk), 4) > 1
               THEN 1
            ELSE ROUND ((occ.avg_hours / occ.std_hours_wk), 4)
         END AS fte_raw,
         job.company_code, job.paygrp
    FROM mb18_ods_alesco.ah_occupancy occ,
         mb18_ods_alesco.job job,
         (SELECT   emplid, MAX (extended_effdt_end) max_extended_end
              FROM mb18.employment_history
             WHERE SOURCE = 'PSOFT'
          GROUP BY emplid) hist
   WHERE occ.employee_no = hist.emplid(+)
     AND occ.employee_no = job.employee#
     AND occ.job_no = job.job#
     AND occ.portion_end > NVL (max_extended_end, '23-APR-2011')
     AND occ.position_no <> '1001'
     AND occ.emp_status <> 'N'
     AND job.paygrp <> 'NPAY'
     AND occ.portion_start <=
                        (SELECT date_value
                           FROM mb18.constants
                          WHERE NAME = 'LAST_DATE_TO_CALC_BACKPAY_FOR_ALESCO')
--and occ.employee_no='141869' and job_no='01' and portion_start='3/may/2014'
                          
GROUP BY occ.employee_no,
         occ.original_employee_no,
         occ.job_no,
         portion_start,
         occ.portion_end,
         occ.avg_hours,
         occ.std_hours_wk,
         job.company_code,
         job.paygrp,
         max_extended_end]]></con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="64553b38-1e33-4ee0-b43e-70846d92cec9" discardOkResults="true" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST2a - all records copy directly from occupancy3 to occupancy_clean" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description/><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="8d66889b-f152-40b7-8226-d7a750561434"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT emplid, orig_emplid, effdt_start, effdt_end, job_no
  FROM mb18.alesco_occupancy_clean_3
MINUS
SELECT emplid, orig_emplid, effdt_start, effdt_end, job_no
  FROM mb18.alesco_occupancy_clean</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="60d81b85-b17e-4e83-8cf4-df24d3b33cd5" discardOkResults="true" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST2b - all records in occupancy_clean have come through from occupancy3" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="7079c007-3d8f-4d0a-8f17-b8bb12858a20"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT emplid, orig_emplid, effdt_start, effdt_end, job_no
  FROM mb18.alesco_occupancy_clean
MINUS
SELECT emplid, orig_emplid, effdt_start, effdt_end, job_no
  FROM mb18.alesco_occupancy_clean_3</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="06727005-5908-4287-8007-18cc52ddd9b3" discardOkResults="true" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST3 - ensure rosters have been split correctly where needed and that correct roster code and offset has come through" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="42dd1a7b-3def-46b6-9a53-50731a509c55"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT employee#, job#, start_date, roster, offset
  FROM mb18_ods_alesco.emp_roster a,
       (SELECT   emplid, job_no, MIN (effdt_start) AS effdt_start
            FROM mb18.alesco_occupancy_clean_1
        GROUP BY emplid, job_no) b,
       (SELECT emplid, job_no, effdt_start, occup_type
          FROM mb18.alesco_occupancy_clean_1) c
 WHERE a.employee# = b.emplid
   AND a.job# = b.job_no
   AND a.employee# = c.emplid
   AND a.job# = c.job_no
   AND a.start_date = c.effdt_start
   AND a.occup_type = c.occup_type
   AND start_date BETWEEN b.effdt_start
                      AND MB18.CONSTANTS_API.get_date_value('LAST_DATE_TO_CALC_BACKPAY_FOR_ALESCO')  
  and (a.employee#, a.start_date) != (select '0831056', '13-Mar-2011' from dual)   -- JW 22-Aug-2018 incorrect roster_code
MINUS
SELECT emplid, job_no, effdt_start, roster_code, roster_offset
  FROM mb18.alesco_occupancy_clean</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="25781049-1880-427e-a0bd-167d460d4453" discardOkResults="true" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST4 - no overlaps in occupancy_clean" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="26d25837-1635-4610-85dd-bdefb597679f"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT   occ1.emplid, occ1.orig_emplid, occ1.job_no, occ1.effdt_start,
         occ1.effdt_end, occ1.action, occ1.company, occ1.paygroup,
         CASE
            WHEN effdt_start &lt;
                   LAG (effdt_end) OVER (PARTITION BY emplid ORDER BY effdt_start)
               THEN 'OVERLAP W/ PRIOR'
            ELSE ''
         END overlaps
    FROM mb18.alesco_occupancy_clean occ1
   WHERE emplid IN (
            SELECT DISTINCT occ1.emplid
                       FROM mb18.alesco_occupancy_clean occ1 JOIN mb18.alesco_occupancy_clean occ2
                            ON (    occ1.emplid = occ2.emplid
                                AND occ1.job_no = occ2.job_no
                                AND occ1.ROWID &lt;> occ2.ROWID
                               )
                      WHERE occ1.effdt_start BETWEEN occ2.effdt_start
                                                 AND occ2.effdt_end)
ORDER BY emplid, effdt_start</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="f38e903d-5ee1-420a-bdd0-58c61c0bb544" discardOkResults="true" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST5 - check that extended end date is not earlier than end date on the row" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="4cc0daeb-eb9e-4421-9676-8fb7fbb25707"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT *
  FROM mb18.alesco_occupancy_clean
 WHERE extended_effdt_end &lt; effdt_end</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="772c4b0b-7e5b-4379-ba2a-5dc8801d5cbd" discardOkResults="true" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST6 - check that start date is not greater than end date" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="f1a7083f-3263-49f1-b11d-a45da9d11af5"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT *
  FROM mb18.alesco_occupancy_clean
 WHERE effdt_start > effdt_end</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="af8e7a24-f651-4165-9966-1e81d889ace6" discardOkResults="true" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST7 - check that all part-time and casual employees have a roster code." searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>Legitimate ones have a note explaining - blank rows will appear at the top so if the top row has a note then everything passes</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="d3cc094b-967c-4a56-bd3b-de380bc23e2c"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT   emplid, effdt_start, effdt_end, job_no, std_hours, roster_code,
         CASE
            WHEN (emplid = '0832959' AND effdt_start = '10-Jan-2011')
                THEN 'Adjacent rows have the same std_hours therefore row should remain blank'
            WHEN (emplid = '0802161' AND effdt_start = '24-APR-2011')
              or (emplid = '0812270' AND effdt_start in ('01-FEB-2013','30-MAR-2014'))
              or (emplid = '0817013' AND effdt_start = '24-APR-2011')
              or (emplid = '0833188' AND effdt_start = '01-Nov-2010')
              or (emplid = '0835292' AND effdt_start = '15-Nov-2010')
               THEN 'Adjacent rows have different std_hours therefore row should remain blank'
            WHEN emplid = '0802161' AND effdt_start = '01-Aug-2010'
               THEN 'No other employment history rows for this employee therefore row should remain blank'    
            WHEN (emplid = '0818351' AND effdt_start in ('01-Aug-2010','30-Mar-2014','05-Oct-2014','30-Jun-2014','01-Jul-2014','07-Sep-2014','01-Nov-2014','01-Jul-2015','26-Jun-2016','01-Jul-2016','01-Nov-2016','01-Jul-2017','01-Nov-2017'))
              or (emplid = '0818351' AND effdt_start in ('24-APR-2011','01-JUL-2011','01-NOV-2011','26-FEB-2012','01-JUL-2012','21-OCT-2012','01-NOV-2012','01-JUL-2013','01-NOV-2013'))            
              or (EMPLID = '0828562' AND EFFDT_START in ('21-Sep-2014','07-Sep-2014','30-Jun-2014','01-Nov-2010','01-Nov-2014','21-Feb-2016','01-Nov-2015','01-Jul-2015','19-Apr-2015'))
              or (emplid = '0825324' AND effdt_start in ('20-Sep-2010','24-APR-2011','17-JUL-2011'))
               THEN 'Adjacent rows also do not have a roster code therefore row should remain blank'
            WHEN emplid = '0827012' AND effdt_start = '29-MAY-2011'
               THEN 'Adjacent rows have different std_hours therefore row should remain blank'
            WHEN emplid = '0827615' AND effdt_start = '15-FEB-2014'
               THEN 'Adjacent rows have different std_hours therefore row should remain blank'
            WHEN emplid = '0827615' AND effdt_start = '01-MAR-2014'
               THEN 'Adjacent rows have different std_hours therefore row should remain blank'
            WHEN emplid = '0828562' AND effdt_start = '24-APR-2011'
               THEN 'Adjacent rows also do not have a roster code therefore row should remain blank'
            WHEN emplid = '0828562' AND effdt_start = '01-JUL-2011'
               THEN 'Adjacent rows also do not have a roster code therefore row should remain blank'
            WHEN emplid = '0828562' AND effdt_start = '01-NOV-2011'
               THEN 'Adjacent rows also do not have a roster code therefore row should remain blank'
            WHEN emplid = '0828562' AND effdt_start = '04-DEC-2011'
               THEN 'Adjacent rows also do not have a roster code therefore row should remain blank'
            WHEN emplid = '0828562' AND effdt_start = '01-JUL-2012'
               THEN 'Adjacent rows also do not have a roster code therefore row should remain blank'
            WHEN emplid = '0828562' AND effdt_start = '01-NOV-2012'
               THEN 'Adjacent rows also do not have a roster code therefore row should remain blank'
            WHEN emplid = '0828562' AND effdt_start = '01-JUL-2013'
               THEN 'Adjacent rows also do not have a roster code therefore row should remain blank'
            WHEN emplid = '0828562' AND effdt_start = '28-JUL-2013'
               THEN 'Adjacent rows also do not have a roster code therefore row should remain blank'
            WHEN emplid = '0828562' AND effdt_start = '01-NOV-2013'
               THEN 'Adjacent rows also do not have a roster code therefore row should remain blank'
            WHEN emplid = '0829579' AND effdt_start = '01-MAY-2011'
               THEN 'Adjacent rows also do not have a roster code therefore row should remain blank'
            WHEN emplid = '0829579' AND effdt_start = '01-MAY-2011'
               THEN 'Adjacent rows also do not have a roster code therefore row should remain blank'
            WHEN emplid = '0829579' AND effdt_start = '01-JUL-2011'
               THEN 'Adjacent rows also do not have a roster code therefore row should remain blank'
            WHEN emplid = '0829579' AND effdt_start = '09-OCT-2011'
               THEN 'Adjacent rows also do not have a roster code therefore row should remain blank'
            WHEN emplid = '0829579' AND effdt_start = '08-APR-2012'
               THEN 'Adjacent rows also do not have a roster code therefore row should remain blank'
            WHEN emplid = '0829760' AND effdt_start = '24-DEC-2011'
               THEN 'Adjacent rows have different std_hours therefore row should remain blank'
            WHEN emplid = '0831514' AND effdt_start = '01-JUL-2011'
               THEN 'Adjacent rows also do not have a roster code therefore row should remain blank'
            WHEN emplid = '0832867' AND effdt_start = '31-JUL-2011'
               THEN 'Adjacent rows have different std_hours therefore row should remain blank'
            WHEN emplid = '0832959' AND effdt_start = '24-APR-2011'
               THEN 'Adjacent rows also do not have a roster code therefore row should remain blank'
            WHEN emplid = '0832959' AND effdt_start = '05-JUN-2011'
               THEN 'Adjacent rows also do not have a roster code therefore row should remain blank'
            WHEN emplid = '0832959' AND effdt_start = '01-JAN-2012'
               THEN 'Adjacent rows also do not have a roster code therefore row should remain blank'
            WHEN emplid = '0832959' AND effdt_start = '15-JAN-2012'
               THEN 'Adjacent rows also do not have a roster code therefore row should remain blank'
            WHEN emplid = '0833188' AND effdt_start = '24-APR-2011'
               THEN 'Adjacent rows have different std_hours therefore row should remain blank'
            WHEN emplid = '0834268' AND effdt_start = '01-OCT-2014'
               THEN 'Adjacent rows have different std_hours therefore row should remain blank'
            WHEN emplid = '0834641' AND effdt_start = '21-MAY-2012'
               THEN 'Adjacent rows have different std_hours therefore row should remain blank'
            WHEN emplid = '0834641' AND effdt_start = '01-JUL-2012'
               THEN 'Adjacent rows have different std_hours therefore row should remain blank'
            WHEN emplid = '0834662' AND effdt_start = '25-JUN-2012'
               THEN 'Adjacent rows have different std_hours therefore row should remain blank'
            WHEN emplid = '0834662' AND effdt_start = '15-JUL-2012'
               THEN 'Adjacent rows have different std_hours therefore row should remain blank'
            WHEN emplid = '0834993' AND effdt_start = '08-MAY-2011'
               THEN 'Adjacent rows also do not have a roster code therefore row should remain blank'
            WHEN emplid = '0834993' AND effdt_start = '01-JUL-2011'
               THEN 'Adjacent rows also do not have a roster code therefore row should remain blank'
            WHEN emplid = '0834993' AND effdt_start = '09-OCT-2011'
               THEN 'Adjacent rows also do not have a roster code therefore row should remain blank'
            WHEN emplid = '0835292' AND effdt_start = '24-APR-2011'
               THEN 'Adjacent rows have different std_hours therefore row should remain blank'
            WHEN emplid = '0835722' AND effdt_start = '14-AUG-2011'
               THEN 'Adjacent rows have different std_hours therefore row should remain blank'
            WHEN emplid = '0835722' AND effdt_start = '22-AUG-2011'
               THEN 'Adjacent rows have different std_hours therefore row should remain blank'
            WHEN emplid = '0835907' AND effdt_start = '11-MAR-2012'
               THEN 'Adjacent rows have different std_hours therefore row should remain blank'
            WHEN emplid = '1000188' AND effdt_start = '30-MAY-2011'
               THEN 'No other employment history rows for this employee therefore row should remain blank'
            WHEN (emplid = '1000574' AND effdt_start = '26-FEB-2012')
              or (emplid = '0817013' AND effdt_start = '01-Nov-2010')
               THEN 'Adjacent rows have different std_hours therefore row should remain blank'
            WHEN emplid = '1000574' AND effdt_start = '22-JUL-2012'
               THEN 'Adjacent rows have different std_hours therefore row should remain blank'
            WHEN emplid = '1000574' AND effdt_start = '01-NOV-2012'
               THEN 'Adjacent rows have different std_hours therefore row should remain blank'
            WHEN emplid = '1000574' AND effdt_start = '02-DEC-2012'
               THEN 'Adjacent rows have different std_hours therefore row should remain blank'
            WHEN emplid = '1000574' AND effdt_start = '16-DEC-2012'
               THEN 'Adjacent rows have different std_hours therefore row should remain blank'
            WHEN emplid = '1000841' AND effdt_start = '05-FEB-2012'
               THEN 'Adjacent rows have different std_hours therefore row should remain blank'
            WHEN emplid = '1000841' AND effdt_start = '26-FEB-2012'
               THEN 'Adjacent rows have different std_hours therefore row should remain blank'
            WHEN emplid = '1000841' AND effdt_start = '05-MAR-2012'
               THEN 'Adjacent rows have different std_hours therefore row should remain blank'
            WHEN emplid = '1000841' AND effdt_start = '11-MAR-2012'
               THEN 'Adjacent rows have different std_hours therefore row should remain blank'
            WHEN emplid = '1001785' AND effdt_start = '15-MAR-2012'
               THEN 'No other employment history rows for this employee therefore row should remain blank'
            WHEN emplid = '1002450' AND effdt_start = '24-SEP-2012'
               THEN 'No other employment history rows for this employee therefore row should remain blank'
            WHEN ((emplid = '0822169' AND effdt_start = '04-Nov-2015')
                or (emplid = '0810337' AND effdt_start = '06-Jan-2016')            
                or (emplid = '0824883' AND effdt_start = '31-Jan-2015')
                or (emplid = '0835573' AND effdt_start = '01-Mar-2018')
                or (emplid = '1001807' AND effdt_start = '09-Apr-2016')                                                  
                or (emplid = '1005271' AND effdt_start in ('01-Sep-2016', '10-Sep-2016')))
               THEN 'Adjacent rows also do not have a roster code therefore row should remain blank' 
            ELSE ''
         END AS notes
    FROM mb18.alesco_occupancy_clean
   WHERE emp_status IN ('TATP', 'TAPP', 'TP', 'PP', 'C', 'TAC')
     AND fte &lt;> 1
     AND roster_code IS NULL
ORDER BY 7 DESC, 1, 2</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="XPath Match" id="4e7d7bcc-3c60-40f7-bbe1-29f1447cbbaa" name="Match content of [NOTES]"><con:configuration><path>//Results[1]/ResultSet[1]/Row[86]/NOTES[1]/text()</path><content>Adjacent rows also do not have a roster code therefore row should remain blank</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="e91dd15d-a213-4163-8295-98ed436baa7e" discardOkResults="true" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST8 - make sure there are no null extended end dates" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>Legitimate ones have a note explaining - blank rows will appear at the top so if the top row has a note then everything passes</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="bd42dbe0-1339-48fc-bc4a-583a6ff3f22d"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT *
  FROM mb18.alesco_occupancy_clean
 WHERE extended_effdt_end IS NULL</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="15da2d2e-f883-42c2-b4a2-2890d0515466" discardOkResults="true" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST9 - check MS_CEA column" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>Legitimate ones have a note explaining - blank rows will appear at the top so if the top row has a note then everything passes</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="ef466ca0-ad0d-42d4-bc36-15e694318d95"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select distinct a.classification, a.ms_cea from mb18.alesco_occupancy_clean a, MB18.HR_FTE_GRADE_MAPPINGS b
where a.classification=b.grade and nvl(a.ms_cea,'x')&lt;>nvl(b.ms_cea,'y')</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="27687633-bfcc-43ef-8547-e4b69b01ba75" discardOkResults="true" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST10 MSCEA" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>Legitimate ones have a note explaining - blank rows will appear at the top so if the top row has a note then everything passes</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="34be84ac-1720-475c-b1c8-66db3081d290"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from mb18.alesco_occupancy_clean b, mb18.hr_fte_grade_mappings c 
where b.classification=c.grade
and b.ms_cea &lt;> c.ms_cea</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:properties/><con:reportParameters/></con:testSuite><con:testSuite id="db965412-74f3-4e60-97b1-ac28d5998899" name="4020-40 alesco_ppm_days_paid_clean app"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:runType>SEQUENTIAL</con:runType><con:testCase id="d3e58f19-9862-4867-9d9e-91aed0f77c84" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 1 correct orig emplid" searchProperties="true" timeout="0"><con:description>correct orig emplid - if any more oddball characters get into the PPM database this test will fail, find and remove in sql </con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="bf037592-c734-470b-b3a4-1c315ed4e984"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select a.*, b.original_emplid
from
(select a.employee_id ppm_emplid,  b.employee#b, c.employee#c
,case when b.employee#b is not null then to_char(b.employee#b) else to_char('0'||c.employee#c) end orig_emplid_expected
from
(select distinct trim(emplid) employee_id from  MB18.MB18_PPM_TIMESHEETS_RAW
where substr(trim(emplid),1,1) in ('0','1','2','3','4','5','6','7','8','9') and not emplid like '%-%'
)a
,(select employee# employee#b from mb18_ods_alesco.employee_raw) b
,(select employee# employee#c from mb18_ods_alesco.employee_raw) c
where 1=1 and
a.employee_id=b.employee#b(+)
and trim(a.employee_id)=c.employee#c(+)
) a
,(select distinct original_emplid from mb18.alesco_ppm_days_paid_clean) b
where 1=1 and
--a.ppm_emplid='0806290' and
b.original_emplid=a.orig_emplid_expected(+)
and a.orig_emplid_expected is null</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="8a16f445-ecac-4fa5-97e5-b35b207a5655" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST2 PPM clean data has no duplicates and days paid 6 or less no rows=pass;" searchProperties="true" timeout="0"><con:description/><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="0f2bf1d1-a029-4bde-85bc-bdccce606680"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select emplid, expected_pay_end, count(*), sum (ppm_days_paid) from mb18.alesco_ppm_days_paid_clean apd
WHERE not exists ( SELECT 'x' FROM MB18.ALESCO_OCCUPANCY_CLEAN aoc 
            WHERE CLASSIFICATION IN ('NPB11', 'NPA13') and apd.emplid = aoc.emplid)
group by emplid, expected_pay_end
having count(*)&lt;>1 or sum (ppm_days_paid)>=7</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="f5d3e63f-7e6b-449f-9666-8439f05dc366"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>d1522146-17eb-4c86-b81a-92013c065612</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase id="a178b807-e98b-4d8c-a764-5b8a0b98aa1d" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST3 everyone in PPM from Alesco is in person" searchProperties="true" timeout="0"><con:description/><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="b670645a-1e5a-4341-be3a-08ffad4d8b97"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from mb18.alesco_ppm_days_paid_clean a 
,(select * from mb18_ods_alesco.employee) b
where expected_pay_end>='24-apr-2011'
and a.emplid=b.employee#(+) and b.employee# is null</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="39ca7511-0378-4d00-9ca9-579c5c74fe93"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>d1522146-17eb-4c86-b81a-92013c065612</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase id="24997b22-7950-44ce-8ceb-1171e0a6b29b" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 4 everyone in PPM from Alesco is in a valid occupancy" searchProperties="true" timeout="0"><con:description/><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="a0a6069b-085a-485e-a01c-9a0ccc29a970"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select a.* from mb18.alesco_ppm_days_paid_clean a 
,mb18_ods_alesco.ah_occupancy_raw b
where a.expected_pay_end>='24-apr-2011'
and a.emplid=b.employee_no(+) and a.expected_pay_end between nvl (b.portion_start,'01-jan-1900') and nvl (b.portion_end,'01-jan-3000')
and b.employee_no is null</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="6de38458-9344-4c1b-90a3-0a9871ad6440"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>d1522146-17eb-4c86-b81a-92013c065612</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:testCase id="891bdbdd-05c5-4dc3-9d46-956cbced2939" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 5 ms_cea" searchProperties="true" timeout="0"><con:description>correct orig emplid - if any more oddball characters get into the PPM database this test will fail, find and remove in sql </con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="9ce3ed3e-a893-4178-981c-42193e43d0bc"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from mb18.ALESCO_PPM_DAYS_PAID_CLEAN where ms_cea &lt;> 'CEA'</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="5f6e5e11-d4f7-4f0d-9caf-d5e1679a9a88"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>d1522146-17eb-4c86-b81a-92013c065612</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:properties/><con:reportParameters/></con:testSuite><con:testSuite id="b4850407-38ca-4ce9-8b6c-bf47c863b4f0" name="4020-50 ALESCO_PEPAYTRAN_CLEAN apf"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:runType>SEQUENTIAL</con:runType><con:testCase id="46f9ff6a-80aa-40ec-b5fb-2292b5813122" discardOkResults="true" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST2 All rows from preclean got into clean, run each one" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>No rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query - 1" id="347cec94-27b7-470d-bf3b-27ca0faf2528"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select  
'1', emplid, job_no, workdate, paycode, unit 
from mb18.alesco_pepaytran_clean , (select date_value from mb18.constants where name='LAST_DATE_TO_CALC_BACKPAY_FOR_ALESCO' ) c
where 1=1 and ROWNUM &lt;= '50'
and workdate between '24-apr-2011' and c.date_value 
minus
select '1',employee#, job#, workdate, a.paycode, unit 
from mb18.alesco_pepaytran_pre_clean  a, mb18.paycodes_tbl b, (select date_value from mb18.constants where name='LAST_DATE_TO_CALC_BACKPAY_FOR_ALESCO' ) c 
where a.paycode=b.paycode and b.hours_based_yn='Y' 
and workdate between '24-apr-2011' and c.date_value</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="d25f7b93-1153-4fa3-996e-fc555ea7cf76"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 2" id="90e057c0-1758-48df-8101-a9e70aa10309"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select '2',employee#, job#, workdate, a.paycode, unit 
from mb18.alesco_pepaytran_pre_clean  a, mb18.paycodes_tbl b , (select date_value from mb18.constants where name='LAST_DATE_TO_CALC_BACKPAY_FOR_ALESCO' ) c 
where a.paycode=b.paycode and b.hours_based_yn='Y' and  workdate between '24-apr-2011' and c.date_value and employee# != '1004958'  -- JW said to ignore this EMPLOYEE#=1004958 JOB#=01 WORKDATE=08-Mar-14 PAYCODE=OVT15 UNIT=8
minus
select '2',emplid, job_no, workdate, paycode, unit 
from mb18.alesco_pepaytran_clean -- source
, (select date_value from mb18.constants where name='LAST_DATE_TO_CALC_BACKPAY_FOR_ALESCO' ) c  
where  workdate between '24-apr-2011' and c.date_value</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="2fc86efe-5efa-43a7-a804-32139e70a600"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 3" id="0899ddeb-19ac-4c41-84e4-bb47dd648457"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select '3',employee#, job#, workdate, a.paycode, unit 
from mb18.alesco_pepaytran_pre_clean  a, mb18.paycodes_tbl b, (select date_value from mb18.constants where name='LAST_DATE_TO_CALC_BACKPAY_FOR_ALESCO' ) c  
where a.paycode=b.paycode and b.hours_based_yn='Y' and workdate between '24-apr-2011' and c.date_value and employee# != '1004958'  -- JW said to ignore this EMPLOYEE#=1004958 JOB#=01 WORKDATE=08-Mar-14 PAYCODE=OVT15 UNIT=8
minus
select '3', emplid, job_no, workdate, paycode, unit 
from mb18.alesco_pepaytran_clean-- source 
, (select date_value from mb18.constants where name='LAST_DATE_TO_CALC_BACKPAY_FOR_ALESCO' ) c 
where workdate between '24-apr-2011' and c.date_value</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="0fe7ddc7-78fb-4937-a917-39158e4206f1"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 4" id="0a0f27f4-6a92-45bd-92fb-3fc9d6560254"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select '4',emplid, job_no, workdate, paycode, unit from mb18.alesco_pepaytran_clean -- source
, (select date_value from mb18.constants where name='LAST_DATE_TO_CALC_BACKPAY_FOR_ALESCO' ) c  
where workdate between '24-apr-2011' and c.date_value 
minus
select '4',employee#, job#, workdate, a.paycode, unit from mb18.alesco_pepaytran_pre_clean  a, mb18.paycodes_tbl b , (select date_value from mb18.constants where name='LAST_DATE_TO_CALC_BACKPAY_FOR_ALESCO' ) c 
where a.paycode=b.paycode and b.hours_based_yn='Y' and workdate between '24-apr-2011' and c.date_value</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="50605d51-4131-4be2-92d7-a493b91644d6"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="b2c9d5fe-954a-41a1-935a-c07ce6be239a" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST3 paygroup is filled in for all" searchProperties="true" timeout="0"><con:description> No rows = Pass;</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="a0f73c91-3d73-4e4d-87ac-9ab962cf68d9"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from mb18.alesco_pepaytran_clean where paygp is null</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="bbea118c-048f-4ebf-a000-cf179ce347cd" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST4 delete_reason of 'Deleted as no valid occupancy'" searchProperties="true" timeout="0"><con:description>correct orig emplid - if any more oddball characters get into the PPM database this test will fail, find and remove in sql </con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="64462298-fbee-469b-91ef-7defece7e511"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select x.* from 
(select * from mb18.alesco_pepaytran_clean a) x
,(select a.emplid, a.job_no, a.workdate, a.delete_reason, b.portion_start, b.portion_end
from mb18.alesco_pepaytran_clean a 
,mb18_ods_alesco.ah_occupancy b
where a.emplid=b.employee_no and a.job_no=b.job_no and a.workdate between portion_start and portion_end 
) y
where x.emplid=y.emplid(+) and x.job_no=y.job_no(+) and x.workdate=y.workdate(+) 
--and x.emplid='0804044'
and y.emplid is null
and x.delete_reason is null</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="902edbc4-5581-46b8-a8bc-47af6d2761e2" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST5 Checking delete reasons, run each" searchProperties="true" timeout="0"><con:description>No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="67bca888-4444-4188-a753-1aa01c9432ab"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select '1',emplid, job_no, workdate, null,  sum(unit) 
from mb18.alesco_pepaytran_clean 
where delete_reason is null
group by emplid, job_no, workdate
having sum(unit) between -0.1 and 0.1 and abs(sum(unit))>0.1</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="ddcbabfe-fcb2-41fd-9c24-ed91b9d9c7cc" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="Test6 No rogue delete_reasons" searchProperties="true" timeout="0"><con:description>No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="324fec6b-d850-488e-8d78-03f5bfe75489"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select b.*,a.* from mb18.alesco_pepaytran_clean a
,(select * from mb18.al_cashup_to_ignore_raw ) b
where 1=1 and 
a.original_emplid=b.emplid(+) and a.expected_pay_end_date=b.period_end_Date(+)
and delete_reason is not null
and sum_hours_day&lt;>0 and abs(sum_hours_paycode)>0.1 and sum_hours_emp_period&lt;>0 and abs(unit)>0.1 and valid_occupancy_yn='Y' and meal_stop_issue_yn='N' and abs(sum_hours_day)>0.1
and abs(hours)>0 and abs(sum_unit_day)>0.1 and abs(sum_unit_paycode)>0.1
and b.emplid is null</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="e069a07a-cd9e-4ab0-9676-39fd1c273f11" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 7 hourly rate salary is correct" searchProperties="true" timeout="0"><con:description>No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="787ae01d-068b-41ab-a0e1-94c217b44212"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select a.emplid, a.job_no, a.workdate, a.salary_hr, b.rate_hour from mb18.alesco_pepaytran_clean a
,(select * from  mb18.alesco_occupancy_clean )b
where a.emplid=b.emplid(+) and a.job_no=b.job_no(+) and a.workdate between nvl (b.effdt_start, '01-jan-1900') and nvl (b.effdt_end, '01-jan-3000')
and a.salary_hr&lt;>b.rate_hour</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="afd0d0d3-ec69-4275-8675-846ce5a92da2" discardOkResults="true" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="Test 8 Meal start stop issue flag" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query - 1" id="b6240175-2f92-4407-8b53-0403ce10e2d7"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select a.actual_meal_start_1, a.actual_meal_stop_1, b.* from  mb18_ods_alesco.ta_start_stop a, mb18.alesco_pepaytran_clean b
, (select * from mb18.paycodes_tbl where overtime_yn='Y' and source='ALESCO') c 
where  a.actual_meal_start_1 is not null and a.actual_meal_stop_1 is null
and a.employee#=b.emplid and a.job#=b.job_no and a.workdate=b.workdate
and a.accept_code &lt;>'RV'
and b.paycode=c.paycode
and b.deleted_yn='N'
and b.meal_stop_issue_yn='N'</con:query><con:storedProcedure>false</con:storedProcedure><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)1" id="1a18328f-28ab-4e53-a90b-ad73a8650b35"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 2" id="5e09d320-3e79-4b02-9cba-2b22a271586d"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from mb18_ods_alesco.ta_start_stop where employee#='304749' and workdate='2/jul/2012'</con:query><con:storedProcedure>false</con:storedProcedure><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)1" id="1a18328f-28ab-4e53-a90b-ad73a8650b35"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 3" id="4098494b-b3b7-4ec7-ac05-778ad0964ace"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from mb18.alesco_pepaytran_clean where emplid='304749' and workdate='2/jul/2012'</con:query><con:storedProcedure>false</con:storedProcedure><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)1" id="1a18328f-28ab-4e53-a90b-ad73a8650b35"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="be2bdfdd-f9d5-4588-86ba-4daed7f7d9bb" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 9 - check MS_CEA column" searchProperties="true" timeout="0"><con:description>No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="248c4529-2cf8-4a9a-82a5-3b102c9e7803"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select a.emplid, a.job_no, a.workdate, occ.classification,b.ms_cea 
from 
(select * from mb18.alesco_pepaytran_clean )a
,( select * from mb18_ods_alesco.ah_occupancy ) occ
, MB18.HR_FTE_GRADE_MAPPINGS b
where 
a.emplid=occ.employee_no and a.job_no=occ.job_no and a.workdate between occ.portion_start and occ.portion_end 
and occ.classification=b.grade 
and nvl(a.ms_cea,'x')&lt;>nvl(b.ms_cea,'y')</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="338ec845-7f8e-40d0-8387-f5eb3c2883f1" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST H1 (Hours column)" searchProperties="true" timeout="0"><con:description>no rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="7b789578-be0c-4970-bebf-39b80fccdfe0"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select a.emplid, a.job_no, a.workdate, a.salary_hr, b.rate_hour from  mb18.alesco_pepaytran_clean a
,(select * from  mb18.alesco_occupancy_clean) b
where a.emplid=b.emplid and a.job_no=b.job_no
and a.workdate between b.effdt_start and b.effdt_end 
and a.salary_hr &lt;> b.rate_hour</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="f317000b-915e-4055-a228-8f5dda60d9e8" discardOkResults="true" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST H2 Priority is right" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>no rows=pass, run each bit</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query - 1" id="7591a1a1-d305-4545-9f18-6aab1e197ae4"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from mb18.alesco_pepaytran_clean where delete_reason is null and comments='Enhanced Early Retirement' 
minus
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority = 1
union all
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority = 1
minus
select * from mb18.alesco_pepaytran_clean where delete_reason is null and comments='Enhanced Early Retirement'</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 2" id="7ce82804-0870-45c4-bec1-a107e46f7c3d"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from mb18.alesco_pepaytran_clean where delete_reason is null and unit=0 and priority not in (1)
minus
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority = 2
union all
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority = 2
minus
select * from mb18.alesco_pepaytran_clean where delete_reason is null and unit=0 and priority not in (1)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 3" id="c025663d-5b95-4b1c-9d47-8bde1c23d90a"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from mb18.alesco_pepaytran_clean where delete_reason is null and paycode Not like 'XT%' and paycode &lt;> 'PBHOL' and abs(AMT)&lt;1  and priority not in (1,2)
minus
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority =10
union all
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority =10
minus
select * from mb18.alesco_pepaytran_clean where delete_reason is null and paycode Not like 'XT%' and paycode &lt;> 'PBHOL' and abs(AMT)&lt;1  and priority not in (1,2)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 4" id="fef3b156-ae86-40c9-b2eb-43fa35fd7b77"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query><![CDATA[select * from mb18.alesco_pepaytran_clean where delete_reason is null and amt is not null and paycode Not like 'XT%' and paycode <> 'PBHOL' 
    and unit<>1 and abs(rate) <1 and priority not in (1,2,10)
minus
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority =15
union all
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority =15
minus
select * from mb18.alesco_pepaytran_clean where delete_reason is null and amt is not null and paycode Not like 'XT%' and paycode <> 'PBHOL' 
    and unit<>1 and abs(rate) <1 and priority not in (1,2,10)]]></con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 5" id="53e41100-dd57-4177-8140-51546f8f7d7a"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from mb18.alesco_pepaytran_clean where delete_reason is null and amt is not null and paycode Not like 'XT%' and paycode &lt;> 'PBHOL' and unit&lt;>1  and priority not in (1,2,10,15)
minus
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority =20
union all
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority =20
minus
select * from mb18.alesco_pepaytran_clean where delete_reason is null and amt is not null and paycode Not like 'XT%' and paycode &lt;> 'PBHOL' and unit&lt;>1  and priority not in (1,2,10,15)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 6" id="635b40c0-6eed-46e1-88d4-88a8eb4aa909"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from mb18.alesco_pepaytran_clean where delete_reason is null and amt is not null and paycode Not like 'XT%' and paycode &lt;> 'PBHOL' and abs(unit)>=1  and priority not in (1,2,10,15,20)
minus
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority =30
union all
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority =30
minus
select * from mb18.alesco_pepaytran_clean where delete_reason is null and amt is not null and paycode Not like 'XT%' and paycode &lt;> 'PBHOL' and abs(unit)>=1  and priority not in (1,2,10,15,20)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 7" id="f633f217-4e0c-4673-ae66-e6197af5f8bf"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from mb18.alesco_pepaytran_clean where delete_reason is null and paycode like 'XT%' and amt is not null and priority not in (1,2,10,15,20,30)
minus
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority =40
union all
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority =40
minus
select * from mb18.alesco_pepaytran_clean where delete_reason is null and paycode like 'XT%' and amt is not null and priority not in (1,2,10,15,20,30)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 8" id="584e3d93-e926-4cbe-bd98-f5bc894579bc"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from mb18.alesco_pepaytran_clean where delete_reason is null and paycode ='LVANN' and amt is null and abs(unit)&lt;0.1 and priority not in (1,2,10,15,20,30,40)
minus
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority =50
union all
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority =50
minus
select * from mb18.alesco_pepaytran_clean where delete_reason is null and paycode ='LVANN' and amt is null and abs(unit)&lt;0.1 and priority not in (1,2,10,15,20,30,40)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 9" id="b9dbe4e1-7670-45e6-8e95-e24e3339b916"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from mb18.alesco_pepaytran_clean where delete_reason is null and paycode ='LVANN' and amt is null and abs(rate)&lt;=1 and priority not in (1,2,10,15,20,30,40,50)
minus
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority =60
union all
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority =60
minus
select * from mb18.alesco_pepaytran_clean where delete_reason is null and paycode ='LVANN' and amt is null and abs(rate)&lt;=1 and priority not in (1,2,10,15,20,30,40,50)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 10" id="63a135aa-b07f-4140-abb5-2ecc8c4c52b5"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from mb18.alesco_pepaytran_clean where delete_reason is null and paycode ='LVANN' and amt is null and priority not in (1,2,10,15,20,30,40,50,60)
minus
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority =70
union all
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority =70
minus
select * from mb18.alesco_pepaytran_clean where delete_reason is null and paycode ='LVANN' and amt is null and priority not in (1,2,10,15,20,30,40,50,60)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 11" id="a62a473c-dcbe-46f7-8a9a-03f2d0596065"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from mb18.alesco_pepaytran_clean where delete_reason is null and paycode &lt;>'LVANN' and amt is null and rate is not null and priority not in (1,2,10,15,20,30,40,50,60,70)
minus
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority =80
union all
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority =80
minus
select * from mb18.alesco_pepaytran_clean where delete_reason is null and paycode &lt;>'LVANN' and amt is null and rate is not null and priority not in (1,2,10,15,20,30,40,50,60,70)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 12" id="8919d0a2-e2fa-420d-bf73-d1e7c22cd1da"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from mb18.alesco_pepaytran_clean where delete_reason is null and paycode &lt;>'LVANN' and amt is null and rate is not null and abs(unit)&lt;0.1 and priority not in (1,2,10,15,20,30,40,50,60,70,80)
minus
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority =90
union all
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority =90
minus
select * from mb18.alesco_pepaytran_clean where delete_reason is null and paycode &lt;>'LVANN' and amt is null and rate is not null and abs(unit)&lt;0.1 and priority not in (1,2,10,15,20,30,40,50,60,70,80)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 13" id="c0b74ab3-43b6-40d6-91cd-743b84595674"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from mb18.alesco_pepaytran_clean where delete_reason is null and paycode &lt;>'LVANN' and amt is null and rate is not null and abs(unit)>0.1 and priority not in (1,2,10,15,20,30,40,50,60,70,80,90)
minus
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority =100
union all
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority =100
minus
select * from mb18.alesco_pepaytran_clean where delete_reason is null and paycode &lt;>'LVANN' and amt is null and rate is not null and abs(unit)>0.1 and priority not in (1,2,10,15,20,30,40,50,60,70,80,90)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 14" id="8eb5c6c7-f874-4b72-af43-8f3f2e012578"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority not in (1,2,10,15,20,30,40,50,60,70,80,90,100)
minus
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority =999
union all
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority =999
minus
select * from mb18.alesco_pepaytran_clean where delete_reason is null and priority not in (1,2,10,15,20,30,40,50,60,70,80,90,100)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="6c361852-8a14-498a-98f1-0505163a1e00" discardOkResults="true" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST H3 value is correct for the priority" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>run each</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query - 1" id="8a62a795-4f08-40f2-a347-209ac5b9c88c"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select '1',a.* from mb18.alesco_pepaytran_clean a where delete_reason is null and priority in (1,2,10,50,90) and hours&lt;>0</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 2" id="2ee83193-25eb-4ad7-af92-ab0e8e26a3e6"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select '2',a.* from mb18.alesco_pepaytran_clean a where delete_reason is null and priority in (20,70,100,999) 
and (abs(round(hours,2))&lt;>abs(round(unit,2)) or case when amt is null then 1 else sign (hours) end &lt;> sign (amt))</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 3" id="0b13a5fb-4b85-4024-bd3a-70373fdca2e5"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select  '3', a.* from mb18.alesco_pepaytran_clean a where delete_reason is null and priority in (30,40,60,80)
and round(hours,2) &lt;> round(AMT/SALARY_HR,2)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:properties/><con:reportParameters/></con:testSuite><con:testSuite id="e95e6a1d-6ff5-4d87-9353-ea8d0e4202a4" name="4020-60 ALESCO_PEPAYTRAN_HOURLY_CLEAN apf"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:runType>SEQUENTIAL</con:runType><con:testCase id="2460dd1a-2929-4f7b-ae77-8380770c6c8a" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 1 totals match" searchProperties="true" timeout="0"><con:description>No rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="042b8b13-2772-4143-bc86-97e4aca0701b"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select a.*, b.unit_destination 
from
(select a.employee#, job#, workdate, a.paycode, sum(unit) unit_source
from mb18.alesco_pepaytran_pre_clean a, mb18.paycodes_tbl b where a.paycode=b.paycode  and b.source='ALESCO'
group by  a.employee#, job#, workdate, a.paycode
) a
,(select emplid, job_no, workdate, a.paycode, sum(unit) unit_destination 
from mb18.ALESCO_PEPAYTRAN_HOURLY_CLEAN a, mb18.paycodes_tbl b where a.paycode=b.paycode  and b.source='ALESCO'
group by emplid, job_no, workdate, a.paycode
) b
where a.employee#=b.emplid(+) and a.job#=b.job_no(+) and a.workdate=b.workdate(+) and a.paycode=b.paycode(+)
and unit_source &lt;> nvl (unit_destination,0)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="2f78f79d-566d-46fc-915f-aadc9725c84b"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="20216705-e701-476a-a969-5a95d44ff588" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 2 totals match reverse" searchProperties="true" timeout="0"><con:description> No rows = Pass;</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="e214bed0-ab3f-46e5-be73-72f9d6ec447c"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select a.*, b.unit_source 
from

(select emplid, job_no, workdate, a.paycode, sum(unit) unit_destination 
from mb18.ALESCO_PEPAYTRAN_HOURLY_CLEAN a, mb18.paycodes_tbl b where a.paycode=b.paycode and b.source='ALESCO'
group by emplid, job_no, workdate, a.paycode
) a

,(select a.employee#, job#, workdate, a.paycode, sum(unit) unit_source
from mb18.alesco_pepaytran_pre_clean a, mb18.paycodes_tbl b where a.paycode=b.paycode  and b.source='ALESCO'
group by  a.employee#, job#, workdate, a.paycode
) b
where a.emplid=b.employee#(+) and a.job_no=b.job#(+) and a.workdate=b.workdate(+) and a.paycode=b.paycode(+)
and unit_destination &lt;> nvl (unit_source,0)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)1" id="18e69818-1172-4601-82a1-21cb2d4a9684"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)1" id="d9b0fa71-b0a2-4ec5-8bbe-fe4cd1fb0356"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="7b49a827-bdc5-4791-ae77-6566708c41cf" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 3 Unit = 0 and Amt null" searchProperties="true" timeout="0"><con:description>correct orig emplid - if any more oddball characters get into the PPM database this test will fail, find and remove in sql </con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="59e30dae-bab8-4d02-a207-cdb8b1089372"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT count(*) FROM mb18.alesco_pepaytran_hourly_clean where unit = 0 and amt is null</con:query><con:assertion type="XPath Match" id="32586071-e0ce-40b5-8b8b-7c04a2b37441" name="Match content of [COUNT]"><con:configuration><path>//Results[1]/ResultSet[1]/Row[1]/COUNT[1]/text()</path><content>0</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:properties/><con:reportParameters/></con:testSuite><con:testSuite id="580f42ae-60a2-443f-b5c4-9b72cea7673a" name="4020-70 ALESCO_PEPAYTRAN_CASUAL_CLEAN apg"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:runType>SEQUENTIAL</con:runType><con:testCase id="43b04748-f8a0-4759-916c-b3e629984dda" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 1 totals match" searchProperties="true" timeout="0"><con:description>No rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="52acd868-8f5f-4dab-9813-528ccdf6c084"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select a.*, b.hours_destination 
from
(select a.emplid, job_no, workdate, sum(hours) hours_source
from mb18.alesco_pepaytran_clean a, mb18.paycodes_tbl b where deleted_yn = 'N' and a.paycode = b.paycode  and b.source = 'ALESCO' and hours_based_yn = 'Y' and overtime_yn = 'N' and upper(type) &lt;> 'LWOP'
group by  a.emplid, job_no, workdate
) a
,(select emplid, job_no, workdate, sum(hours) hours_destination 
from mb18.alesco_pepaytran_casual_clean a
group by emplid, job_no, workdate
) b
where 
a.emplid = b.emplid (+) 
and a.job_no = b.job_no (+) 
and a.workdate = b.workdate(+) 
and hours_source &lt;> nvl (hours_destination,0)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="9acb8480-eeea-45fd-ae8b-ba4cbbf8290c"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="e15f79b1-73d8-4e4c-9731-f1f809a5fb0c" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 2 totals match reverse" searchProperties="true" timeout="0"><con:description> No rows = Pass;</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="c01b1c0c-d111-4222-a155-7aa208259aae"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select a.*, b.hours_source 
from
(select emplid, job_no, workdate, sum(hours) hours_destination 
from mb18.alesco_pepaytran_casual_clean a
group by emplid, job_no, workdate
) a
,(select a.emplid, job_no, workdate,  sum(hours) hours_source
from mb18.alesco_pepaytran_clean a, mb18.paycodes_tbl b where deleted_yn = 'N' and a.paycode = b.paycode  and b.source = 'ALESCO' and hours_based_yn = 'Y' and overtime_yn = 'N' and upper(type) &lt;> 'LWOP'
group by  a.emplid, job_no, workdate
) b
where 
a.emplid = b.emplid (+) 
and a.job_no = b.job_no (+)  
and a.workdate = b.workdate (+)  
and hours_destination &lt;> nvl (hours_source,0)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:properties/><con:reportParameters/></con:testSuite><con:testSuite id="50c37665-8bb1-494f-9cb9-8c74abee4a42" name="4020-80 ALESCO_ROSTER_HOURS_CLEAN arh -odd table"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:runType>SEQUENTIAL</con:runType><con:testCase id="97be991b-7523-4c6b-96da-1b46be037729" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="Test 1 no conflicts in current  start" searchProperties="true" timeout="0"><con:description>Roaster update tests
No rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="77be043a-2ad2-431a-92a1-f3d7b0e725d6"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select roster_code, current_roster_clean_start, count(*) from mb18.alesco_roster_hours_update group by roster_code, current_roster_clean_start having count(*)>1</con:query><con:assertion type="GroovyScriptAssertion" id="8c29624e-5cd0-4888-9b48-3234923d48a7" name="Assert node [TEST_RESULT]"><con:configuration><scriptText>import com.eviware.soapui.support.XmlHolder

def holder = new XmlHolder( messageExchange.responseContentAsXml )
def results  = holder.getNodeValues("//TEST_RESULT")

results.each { assert "${it}"  == 'Pass' }</scriptText></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="686b5977-fb35-4b5f-926e-b29ef085147c" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="Test 0.5 duplicates" searchProperties="true" timeout="0"><con:description>Roaster update tests
No rows = Pass;</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="1842378e-3528-4e55-acfc-995af5c0e9df"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select roster_code, day_num, start_date, count(*) from mb18.alesco_roster_hours_clean group by roster_code, day_num, start_date
having count(*)>1 </con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="3f7047ec-f36a-4f08-b865-1bf62dc30226" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 1 - no overlaps" searchProperties="true" timeout="0"><con:description>correct orig emplid - if any more oddball characters get into the PPM database this test will fail, find and remove in sql </con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="223127e4-7881-4457-bb75-c48b5f0adf9d"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT pj.roster_code
       , pj.start_date
       , pj.end_date
       , pj.day_num
       , pj.original_start_date
       , pj.original_end_date
       , pj.start_date_change_reason
       , CASE WHEN start_date &lt; LAG( end_date ) OVER (PARTITION BY roster_code, day_num ORDER BY start_date) THEN 'OVERLAP W/ PRIOR' ELSE '' END overlaps
    FROM 
    (select CASE WHEN start_date &lt; LAG( end_date ) OVER (PARTITION BY roster_code, day_num ORDER BY start_date) THEN 'OVERLAP W/ PRIOR' ELSE '' END overlaps, pj.* from mb18.alesco_roster_hours_clean pj )pj
   WHERE roster_code IN (SELECT DISTINCT pj.roster_code
                      FROM mb18.alesco_roster_hours_clean pj JOIN mb18.alesco_roster_hours_clean pj1 ON ( pj.roster_code = pj1.roster_code and pj.day_num=pj1.day_num AND pj.ROWID &lt;> pj1.ROWID )
                     WHERE pj.start_date BETWEEN pj1.start_date AND pj1.end_date)
and overlaps is not null
ORDER BY 
roster_code, day_num, start_date</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="7fbd75c9-87af-434b-97a0-a145fd14b58f" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 2 - no gaps" searchProperties="true" timeout="0"><con:description>No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="a55bda99-4ee7-4dc7-897a-fbce60765372"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select roster_code, day_num, sum (end_date-start_date+1) actual_days_in_range 
, to_date (b.date_value,'dd/mm/yyyy') - to_date ('01/01/1950','dd/mm/yyyy')+1 expected_days_in_range  
from mb18.alesco_roster_hours_clean a, mb18.constants b
where b.name='LAST_DATE_TO_CALC_BACKPAY_FOR_ALESCO'
group by roster_code, day_num,b.date_value
having sum (end_date-start_date+1) &lt;> to_date (b.date_value,'dd/mm/yyyy') - to_date ('01/01/1950','dd/mm/yyyy')+1</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Results></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="4a0c90a5-e347-484f-a66a-b1ec6b077618" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST - 3 test of two average WHERE 7 ROWS PER START_DATE ONLY cols" searchProperties="true" timeout="0"><con:description>zero rows equals pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="63aad6c2-283c-4db3-af76-083e3491b38a"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select a.roster_code, a.start_date 
,a.expected_avg_daily_hours, b.avg_daily_hours
,expected_days_per_roster/(counter/7) expected_days_per_week, b.days_per_week from
(select x.roster_code, x.start_date, avg (x.hours_per_day) expected_avg_daily_hours,  count(x.hours_per_day) expected_days_per_roster from
(select * from  mb18.ALESCO_ROSTER_HOURS_CLEAN where hours_per_day&lt;>0) x
group by x.roster_code, x.start_date
) a

,(select distinct roster_code, start_date, avg_daily_hours, days_per_week from mb18.ALESCO_ROSTER_HOURS_CLEAN) b
,(select count(*) counter, roster_code, start_date from mb18.ALESCO_ROSTER_HOURS_CLEAN group by roster_code, start_date having count(*) in (7,14,21,28,35,42,49,56,63,70)) c
where a.roster_code=b.roster_code and a.start_date=b.start_date  
and a.roster_code=c.roster_code and a.start_date=c.start_date

 and  (round(a.expected_avg_daily_hours,4)&lt;>round(b.avg_daily_hours,4) or round(b.days_per_week,4)&lt;>round(expected_days_per_roster/(counter/7),4))</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="a8ff91a0-0f52-4916-b138-feefa4ab1260" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 4 non-7 days per roster and start date" searchProperties="true" timeout="0"><con:description>No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="9c32e55f-b227-4212-adc7-bc26e2652f9f"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select 
x.roster_code, x.start_date , x.avg_daily_hours,avg (hours_per_day) expected_avg_daily_hours
, x.days_per_week  
,case 
when roster_code='C90I' and x.start_date='16/dec/2012' then count(hours_per_day)/2  
when roster_code='C1H5' and x.start_date='15/dec/2013' then count(hours_per_day)/2 
when roster_code='C7OM' and x.start_date='14/aug/2016' then count(hours_per_day)/4
when roster_code='CN222' and x.start_date='5/feb/2017' then count(hours_per_day)/3    
else 
count(hours_per_day)
end
from
(
select  a.roster_code, a.start_date, b.day_num, b.hours_per_day, b.avg_daily_hours, b.days_per_week from 
(select roster_code, start_date, count(*) from mb18.ALESCO_ROSTER_HOURS_CLEAN group by roster_code, start_date having count(*) not in (7,14,21,28,35,42,49,56,63,70) 
 --and roster_code='C7OM'
) a
, mb18.ALESCO_ROSTER_HOURS_CLEAN b where 
 b.roster_code=a.roster_code and a.start_date between b.start_date and b.end_date
 and hours_per_day&lt;>0
-- and roster_code='C7OM'
) x

where x.roster_code in (select roster from MB18_ODS_ALESCO.EMP_ROSTER )

group by x.roster_code, x.start_date, x.avg_daily_hours, x.days_per_week
having x.avg_daily_hours&lt;>avg (hours_per_day) or  x.days_per_week &lt;> 
case 
when roster_code='C90I' and x.start_date='16/dec/2012' then count(hours_per_day)/2  
when roster_code='C1H5' and x.start_date='15/dec/2013' then count(hours_per_day)/2  
when roster_code='C7OM' and x.start_date='14/aug/2016' then count(hours_per_day)/4
when roster_code='CN222' and x.start_date='5/feb/2017' then count(hours_per_day)/3    
else
count(hours_per_day)
end</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="8eda78b5-b9aa-40cf-95d7-9aba482dbe0f" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 5 Check source mb18_ODS_ALESCO.ROSTER_HOURS and _DEL" searchProperties="true" timeout="0"><con:description>not quite sure if this is a valid test, of rows appear needs checking out but could be ok
No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="daef98c7-1ea3-48b2-8148-4d297fa3e7bc"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select '1',roster_code, day_num, hours_per_day from  mb18.ALESCO_ROSTER_HOURS_CLEAN where rdp_source='mb18_ODS_ALESCO.ROSTER_HOURS'
minus
select '1',roster, sequence, case when hours_per_day=0.1 then 0 else hours_per_day end hours_per_day from  mb18_ods_ALESCO.ROSTER_HOURS
union all
select '2',roster_code, day_num, hours_per_day from  mb18.ALESCO_ROSTER_HOURS_CLEAN where rdp_source='mb18_ODS_ALESCO.ROSTER_HOURS_DEL'
minus
select '2',roster, sequence, case when hours_per_day=0.1 then 0 else hours_per_day end hours_per_day from  mb18_ods_ALESCO.ROSTER_HOURS_DEL</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="b1aa19e9-8554-487a-b1ad-71ba454a9ba9" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 6 Check all rosters with the last date of Alesco match the main ods table;" searchProperties="true" timeout="0"><con:description>No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="3b3cfccf-51e2-4da3-a077-af8c4baa5f35"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select roster, sequence, case when hours_per_day=0.1 then 0 else hours_per_day end hours_per_day from  mb18_ods_ALESCO.ROSTER_HOURS
where roster in (select roster from mb18_ods_alesco.emp_roster)
minus
select roster_code, day_num, hours_per_day from  mb18.ALESCO_ROSTER_HOURS_CLEAN where end_date = (select date_value from mb18.constants where name='LAST_DATE_TO_CALC_BACKPAY_FOR_ALESCO')</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="5e77165f-3275-4e0a-94ad-51bba6779dfb" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 7 checks all rosters with a DEL source are in the DEL table" searchProperties="true" timeout="0"><con:description>No rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="fbac0f46-8b7e-4cef-8464-10f9d9344a14"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from mb18.ALESCO_ROSTER_HOURS_CLEAN  
where 1=1  
and rdp_source='mb18_ODS_ALESCO.ROSTER_HOURS_DEL'
and end_date &lt;> (select date_value from mb18.constants where name='LAST_DATE_TO_CALC_BACKPAY_FOR_ALESCO')
and roster_code not in (select roster from mb18_ods_ALESCO.ROSTER_HOURS_del)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="bde89130-3ea4-4c38-a396-5e0b6cfac100" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 8 switch of test7" searchProperties="true" timeout="0"><con:description>no rows is pass.  
No idea why C846 comes up but manually checked not sure if this is a valid test to run but leaving in case it is as it was hard work!</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="2678554a-3af6-45b2-bb78-e0f37e23642c"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select a.* from
(select roster, start_date,sequence,hours_per_day from 
(select roster,tp start_date,sequence,hours_per_day, tp_time from mb18_ods_ALESCO.ROSTER_HOURS -- where roster='C846' and sequence=7
union all
select roster,tp start_date,sequence,hours_per_day, tp_time from mb18_ods_ALESCO.ROSTER_HOURS_del  --where roster='C846' and sequence=7 
) a
where a.tp_time=
    (select max (a_ed.tp_time) from 
            (select roster,tp ,sequence,hours_per_day, tp_time from mb18_ods_ALESCO.ROSTER_HOURS  --where roster='C846' and sequence=7
            union all
            select roster,tp ,sequence,hours_per_day, tp_time from mb18_ods_ALESCO.ROSTER_HOURS_del  --where roster='C846' and sequence=7 
            ) a_ed
where a.roster=a_ed.roster and a.sequence=a_ed.sequence and a.start_date=a_ed.tp )
) a 
,(select roster_code,start_date,day_num,hours_per_day from mb18.ALESCO_ROSTER_HOURS_CLEAN where rdp_source='mb18_ODS_ALESCO.ROSTER_HOURS_DEL' and end_date &lt;> (select date_value from mb18.constants where name='LAST_DATE_TO_CALC_BACKPAY_FOR_ALESCO')) b
where 
a.roster=b.roster_code
and a.start_date=b.start_date
and a.sequence=b.day_num
and a.hours_per_day=b.hours_per_day
and b.roster_code is null
and a.start_date>='24-apr-2011'
and not (a.roster='C846' and a.start_date='23-nov-2011' and a.sequence=7)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="ef85deac-8256-4839-a2e7-318f3a78a666" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST9 roster_cycle" searchProperties="true" timeout="0"><con:description>no rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="27b479d7-01ce-4024-b008-a7bc2f8d17eb"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select roster_code ,max(day_num), roster_cycle from mb18.alesco_roster_hours_clean group by roster_code,roster_cycle 
having max(day_num)&lt;> roster_cycle</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="c997d433-3615-4da2-ac79-a005989630b8" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST10 week_num" searchProperties="true" timeout="0"><con:description>no rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="21f4ae8c-56ec-4b0b-ac97-2572b48611ef"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select roster_code, day_num, ceil(day_num/7), week_num from mb18.alesco_roster_hours_clean
where ceil(day_num/7)&lt;>week_num</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="99254472-b543-42e5-867b-0b4daba49256" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="Test 11 Check no change reason" searchProperties="true" timeout="0"><con:description>no rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="10588a4d-1003-4925-babb-174a209ca8f3"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from mb18.alesco_roster_hours_clean where start_date=original_start_date and end_date=original_end_Date and start_date_change_reason&lt;>'No Change'
union all
select * from mb18.alesco_roster_hours_clean where (start_date&lt;>original_start_date or end_date&lt;>original_end_Date) and start_date_change_reason='No Change'</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="1e3c8153-7233-4770-9bcf-bb093e49224d" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="Test 12 new start_date" searchProperties="true" timeout="0"><con:description>no rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="8e2b50e1-089b-4a54-af80-97f152c5f8db"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select 
case 
when trim(to_char(original_start_date,'DAY'))='MONDAY' then  original_start_date-1
when trim(to_char(original_start_date,'DAY'))='TUESDAY' then  original_start_date-2
when trim(to_char(original_start_date,'DAY'))='WEDNESDAY' then  original_start_date+4
when trim(to_char(original_start_date,'DAY'))='THURSDAY' then  original_start_date+3
when trim(to_char(original_start_date,'DAY'))='FRIDAY' then  original_start_date+2
when trim(to_char(original_start_date,'DAY'))='SATURDAY' then  original_start_date+1
end expected_start
,a.*
from mb18.alesco_roster_hours_clean a
where start_date_change_reason like '%Sunday'
and 
case 
when trim(to_char(original_start_date,'DAY'))='MONDAY' then  original_start_date-1
when trim(to_char(original_start_date,'DAY'))='TUESDAY' then  original_start_date-2
when trim(to_char(original_start_date,'DAY'))='WEDNESDAY' then  original_start_date+4
when trim(to_char(original_start_date,'DAY'))='THURSDAY' then  original_start_date+3
when trim(to_char(original_start_date,'DAY'))='FRIDAY' then  original_start_date+2
when trim(to_char(original_start_date,'DAY'))='SATURDAY' then  original_start_date+1
end
&lt;> start_date</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="7a044c54-6b76-49f4-86df-28d8f23296fb" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST13 end date less than start date" searchProperties="true" timeout="0"><con:description>no rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="e8cbb3ff-6d4d-4832-afad-b25331fb210b"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from mb18.alesco_roster_hours_clean where end_date&lt;start_date</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="1f51daae-961d-4759-815d-7ea377f8ccb9" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 14 each roster matched to old table within 5 days *DEV only*" searchProperties="true" timeout="0" disabled="true"><con:description>*DEV only*
no rows = pass
The table doesnot exist. This is an invalid test now as this table is not being used anymore.</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="f774b7cc-7e7f-4f39-ba02-643f13e76409"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select 
a.*,b.* from 
(select * from mb18.old_roster_hours_191604) a
left outer join mb18.alesco_roster_hours_update c
--start join conditions
on a.roster_code=c.roster_code(+)


left outer join
(select * from mb18.alesco_roster_hours_clean) b

on a.roster_code=b.roster_code
-- start join condiftions
and a.day_num=b.day_num
and a.start_date=b.original_start_date


--where at the end 

where c.roster_code is null
and abs(b.start_date-a.start_date)>4</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="84f8bc0b-c66c-474f-a345-7c414d79175c" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST15 if this comes up with rows review, it may not be a problem" searchProperties="true" timeout="0"><con:description>*DEV only*
no rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="c4000d83-00aa-4e17-af7c-cb84216fff72"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT roster_code, current_roster_clean_start, new_roster_clean_start
  FROM (SELECT DISTINCT a.roster_code, a.effdt_start AS occupancy_start,
                        a.start_date_2 AS current_roster_clean_start,
                        CASE
                           WHEN   a.start_date_2
                                - a.effdt_start &lt; 15
                              THEN b.week_begin_date_time
                           ELSE NULL
                        END AS new_roster_clean_start
                   FROM (SELECT DISTINCT aoc.emplid, aoc.job_no,
                                         aoc.roster_code, aoc.effdt_start,
                                         aoc.effdt_end,
                                         roc.start_date AS start_date_1,
                                         roc.end_date AS end_date_1,
                                         roc2.start_date AS start_date_2,
                                         roc2.end_date AS end_date_2
                                    FROM mb18.employment_history_pre_stg aoc LEFT OUTER JOIN mb18.alesco_roster_hours_clean roc
                                         ON aoc.roster_code = roc.roster_code
                                       AND aoc.effdt_start
                                              BETWEEN roc.start_date
                                                  AND roc.end_date
                                         LEFT OUTER JOIN mb18.alesco_roster_hours_clean roc2
                                         ON aoc.roster_code = roc2.roster_code
                                       AND aoc.effdt_end BETWEEN roc2.start_date
                                                             AND roc2.end_date
                                   WHERE roc.start_date &lt;> roc2.start_date
                                     AND aoc.std_days_per_week IS NULL) a,
                        ads.days b
                  WHERE a.effdt_start = b.actual_date
               ORDER BY a.roster_code, a.effdt_start)
 WHERE new_roster_clean_start IS NOT NULL</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:properties/><con:reportParameters/></con:testSuite><con:testSuite id="ee886c8c-7622-4b78-ada4-ba33bf0edce9" name="4020-90 ALESCO_ROSTERED_HPD_CLEAN ahp"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:runType>SEQUENTIAL</con:runType><con:testCase id="17004d81-1542-4201-bd22-42c5c05bce07" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 1 check for duplicates" searchProperties="true" timeout="0"><con:description>No rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query - 1" id="61f6bda8-b918-4dfe-a2b5-3c92d3ed2ce7"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select emplid, job_no, workdate, count(*) from mb18.ALESCO_ROSTERED_HPD_CLEAN group by emplid, job_no, workdate having count(*)>1 </con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="d25f7b93-1153-4fa3-996e-fc555ea7cf76"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="035cb14f-f8b3-4ab9-adc8-706ad0704705" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 2 data matches source and hours per day matches expected - does not use alesco function" searchProperties="true" timeout="0"><con:description> No rows = Pass;</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="88832e82-7fe2-4067-a258-d8e09861512e"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select a.emplid, a.job_no, a.workdate, a.roster_code_expected,  b.roster_code_actual, a.roster_offset_expected, b.roster_offset_actual
, a.hours_per_day_expected
, b.hours_per_day_actual
from

(select 
a.emplid, a.job_no, b.actual_date workdate, a.roster_code roster_code_expected, a.roster_offset roster_offset_expected, 
case when casual_roster_yn='Y' then d.hours_per_day else r.hours_per_day end hours_per_day_expected
,  r.days_per_week, case when casual_roster_yn='Y' then d.hours_per_day else r.avg_daily_hours end avg_daily_hours ,casual_roster_yn, a.award, a.classification
from 
 (select * from mb18.alesco_occupancy_clean)a  
, ads.days b
,(select * from mb18.alesco_roster_hours_clean  ) r
,(select * from mb18_ods_alesco.classification) d 

where b.actual_date between a.effdt_start and a.effdt_end
and a.roster_code=r.roster_code(+) and b.actual_date between nvl(r.start_date,'01-jan-1900') and nvl(r.end_date, '01-jan-3000')
and a.award=d.award and a.classification=d.classification and b.actual_date between d.start_date and d.end_date 
and a.roster_code=r.roster_code(+)
and day_num= MOD(b.actual_date - (a.effdt_start-(
 CASE TO_CHAR(a.effdt_start,'DY') WHEN 'SUN' THEN 0 WHEN 'MON' THEN 1 WHEN 'TUE' THEN 2 WHEN 'WED' THEN 3 WHEN 'THU' THEN 4 WHEN 'FRI' THEN 5 WHEN 'SAT' THEN 6 END
+roster_offset)),roster_cycle)+1 
and actual_date&lt;= sysdate
) a


,(select emplid, job_no, workdate, roster_code roster_code_actual, roster_offset roster_offset_actual, -1 lwop_hours_booking, hours_per_day hours_per_day_actual, days_per_week, avg_daily_hours, casual_roster_yn, award,  classification 
from mb18.alesco_rostered_hpd_clean
where workdate&lt;=sysdate
) b

where a.emplid=b.emplid(+) and a.job_no=b.job_no(+) and a.workdate=b.workdate(+)
and (b.emplid is null or  a.roster_code_expected&lt;>b.roster_code_actual or a.roster_offset_expected&lt;>b.roster_offset_actual or a.hours_per_day_expected&lt;>b.hours_per_day_actual 
) </con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="990c8193-8c82-436a-9d85-8ccb5d10378e" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 3 Sample of emps tested against the alesco functon" searchProperties="true" timeout="0"><con:description>leave this to run and do the others in a sep tab at the same time- this takes around 40 mins</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="0ce044c3-ba14-4000-b9cf-1ea40b92b0a9"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>with
a as (select * from mb18.alesco_rostered_hpd_clean) 
, b as (select * from mb18_ods_alesco.classification ) 
select emplid, job_no, workdate, a.hours_per_day 
,case when mb18_ods_alesco.get_day_hours (emplid, job_no, workdate)=0.1 then 0 else mb18_ods_alesco.get_day_hours (emplid, job_no, workdate) end hours_per_day_alesco_fn
from a,b
where 
a.award=b.award and a.classification=b.classification and workdate between b.start_date and b.end_date  
and case when mb18_ods_alesco.get_day_hours (emplid, job_no, workdate)=0.1 then b.hours_per_day else mb18_ods_alesco.get_day_hours (emplid, job_no, workdate) end 
&lt;>nvl(a.hours_per_day,9999) 
and emplid in ('0835123','208452','1001391','0804950', '0817963','0817814','0804945')</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="fddb634a-af30-4f38-8d65-eafae4df29e8" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 4 everyone has the right num of rows ie the same as ocupancy date" searchProperties="true" timeout="0"><con:description>No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="2ed2a24f-2778-4e14-a3f5-41f9addd4de4"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select a.emplid, a.num_occ_dates, b.num_rost_hpd_dates
from
(select emplid, sum(effdt_end-effdt_start+1) num_occ_dates from mb18.alesco_occupancy_clean 
group by emplid
) a
,(select emplid, count(*) num_rost_hpd_dates from mb18.alesco_rostered_hpd_clean group by emplid) b
where a.emplid=b.emplid(+)
and (b.num_rost_hpd_dates is null or b.num_rost_hpd_dates&lt;> a.num_occ_dates)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="3179c9e5-8cc0-47c7-9350-c747aabddc25" discardOkResults="true" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST - 5 lwop_hours_booking column data" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="f869f968-d204-4fb3-8c65-bb82883d5067"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select x.original_emplid, x.job_no , x.workdate, x.lwop_hours_booking, hours_per_day, sum (x.expected_lwop_hours) from

(select c.original_emplid, c.job_no , c.workdate, c.lwop_hours_booking,c.hours_per_day,
case 
when a.start_date=a.end_date and lv_unit='H' and end_date=start_date then a.lv_amt
else HOURS_PER_DAY end expected_lwop_hours

from mb18_ods_alesco.lv_bookings_raw a, (select * from mb18_ods_alesco.lv_codes where lv_type='U') b
,mb18.alesco_rostered_hpd_clean c
where a.lv_code=b.lv_code and a.reversal_date is null
and c.original_emplid=a.employee#(+) and c.job_no=a.job#(+) and c.workdate between a.start_date and a.end_date
--and original_emplid='0832818'
) x

,(select * from mb18.alesco_occupancy_clean) y

where 1=1 and 
x.original_emplid=y.orig_emplid and x.job_no=y.job_no and x.workdate between y.effdt_start and y.effdt_end and y.paygroup='FN'
and not (x.original_emplid = '1006206' and  x.workdate in ( '26-Jun-2017', '27-Jun-2017')) -- RWinton(Datacom), JW 23-Aug-2018 double booking in the system
--and x.original_emplid='0832926'

group by x.original_emplid, x.job_no , x.workdate, x.lwop_hours_booking,hours_per_day
having sum (x.expected_lwop_hours)&lt;>x.lwop_hours_booking</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 2" id="f56c8261-55c2-4ee8-b8ac-17864d9a83ae"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>
select * from mb18_ods_alesco.lv_bookings_raw where reversal_date is null and employee#='0832926' and '26/mar/2012' between start_date and end_Date</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 3" id="319e6750-c0b0-4bb8-8c59-52cebc13f7a4"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from  mb18.alesco_rostered_hpd_clean where original_emplid='0832926' and workdate='26/mar/2012'</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="eae6893d-1110-4b67-9377-62665bb2bcf2" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 6 pbhol units in payslip matches that in rostered_hpd" searchProperties="true" timeout="0"><con:description>No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="110846df-25a4-41e2-ada1-62fb9c4142c6"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>with 
a as
(
select emplid, job_no, start_date, sum (unit) PBHOL_UNITS_payslip from mb18.alesco_pehistpay_clean 
where paycode='PBHOL' 
--and emplid='0825251'
group by emplid, job_no,start_date
) 

,b as
(select * from mb18.alesco_rostered_hpd_clean
--where emplid='0825251' and workdate='24/oct/2011'
)

select a.emplid, a.start_date, a.pbhol_units_payslip, b.pbhol_units
from a,b
where a.emplid=b.emplid and a.job_no=b.job_no and a.start_date=b.workdate 
and a.pbhol_units_payslip&lt;>nvl(b.pbhol_units,0) </con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="d259e8a2-503d-4fe2-a77c-387daadcfa00" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 7 pbhol units in rostered_hpd  matches that in payslip" searchProperties="true" timeout="0"><con:description>No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query - 1" id="88b1562b-0715-423e-ac00-58442ec5196d"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>with 
a as
(select emplid, job_no, start_date, sum (unit) PBHOL_UNITS from mb18.alesco_pehistpay_clean 
where paycode='PBHOL' 
--and emplid='0804594'
group by emplid, job_no, start_date) 

,b as
(select * from mb18.alesco_rostered_hpd_clean)
select a.emplid, a.start_date, a.pbhol_units, b.pbhol_units
from a,b
where b.emplid=a.emplid(+) and b.job_no=a.job_no(+) and b.pbhol_units&lt;>nvl(b.pbhol_units,0) </con:query><con:storedProcedure>false</con:storedProcedure><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)1" id="1a18328f-28ab-4e53-a90b-ad73a8650b35"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="126be1fc-fa2a-4352-954f-35a6f9adfdaa" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 8 - check MS_CEA column" searchProperties="true" timeout="0"><con:description>No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="7b783c10-4a45-4423-b5ec-ce03bc69f9de"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select a.classification, a.ms_cea from mb18.alesco_rostered_hpd_clean a, MB18.HR_FTE_GRADE_MAPPINGS b
where a.classification=b.grade and nvl(a.ms_cea,'x')&lt;>nvl(b.ms_cea,'y')</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:properties/><con:reportParameters/></con:testSuite><con:testSuite id="34518b9a-7417-45e1-91e3-c9a4c1da88f2" name="4020-100 ALESCO_ACTUAL_HPD_CLEAN aah xxx"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:runType>SEQUENTIAL</con:runType><con:testCase id="85fadff3-9881-4cc4-a301-3fa8bbbde883" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST 1 hours match paytran_clean to actual_hpd_clean non_PPM" searchProperties="true" timeout="3600000" maxResults="500" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>No rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query - 1" id="1c5c9b9a-a5c1-43be-bf06-d0721c9bd405"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select a.*, b.hours_actual_hpd from

(select x.emplid, x.job_no, x.workdate, x.paycode, paygp, x.company, sum(x.hours) hours_paytran from mb18.alesco_pepaytran_clean x, mb18.alesco_actual_hpd_clean y
    where delete_reason is null 
    and x.emplid=y.emplid(+) and x.expected_pay_end_date=y.expected_pay_end_date(+)
    and y.emplid is null 
    group by x.emplid, x.job_no, x.workdate, x.paycode, paygp, x.company) a
    
    
,(select emplid, job_no, workdate, paycode, paygroup, company, sum(hours) hours_actual_hpd from mb18.alesco_actual_hpd_clean a 
    where paycode&lt;>'PPM' group by emplid, job_no, workdate, paycode, paygroup, company) b
where 
a.emplid=b.emplid(+) and  a.job_no=b.job_no(+) and  a.workdate=b.workdate(+) and a.paycode=b.paycode(+) and  a.paygp=b.paygroup(+) and a.company=b.company(+)
and  hours_paytran&lt;> nvl (hours_actual_hpd,0)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="75e0d0f7-903e-449c-99e3-a04325803f41"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 2" id="f3de493a-4097-49bc-b82f-bc749f6bd257"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from  mb18.alesco_pepaytran_clean where emplid= '0800272' and workdate='22/oct/2013' and job_no='01' and paycode='STDHR'</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="7e0fdc37-fac1-4c85-acd0-cf9030e52c37"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 3" id="16875e64-6da9-4a4d-b186-5443a9bec32e"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from  mb18.alesco_ppm_days_paid_clean where emplid= '0800272'</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="3682f1ec-c569-4e29-95f2-3f1118505932"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 4" id="ba205993-b46b-4c88-9f73-1a448b5dc5b9"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from  mb18.alesco_actual_hpd_clean where emplid= '0800272' and workdate='22/oct/2013'  and paycode='STDHR' and job_no='01'</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="92011142-3c41-41bd-b5e4-998d4426ce8e"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="76fde294-8f10-4bc3-84dd-72305b6bcbd2" discardOkResults="true" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST 2" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>Roaster update tests
No rows = Pass;</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query - 1" id="695b4c25-9eaa-48e0-95be-ac39769b4a97"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select a.*, b.hours_paytran from
(select emplid, job_no, workdate, paycode, paygroup, company, sum(hours) hours_actual_hpd from mb18.alesco_actual_hpd_clean a 
    where paycode&lt;>'PPM' and rdp_source&lt;>'ALESCO_ROSTERED_HPD_CLEAN' 
    group by emplid, job_no, workdate, paycode, paygroup, company) a
    
,(select x.emplid, x.job_no, x.workdate, x.paycode, paygp, x.company, sum(x.hours) hours_paytran from mb18.alesco_pepaytran_clean x
    where delete_reason is null 
    group by x.emplid, x.job_no, x.workdate, x.paycode, paygp, x.company) b
where 
a.emplid=b.emplid(+) and  a.job_no=b.job_no(+) and  a.workdate=b.workdate(+) and a.paycode=b.paycode(+) and  a.paygroup=b.paygp(+) and a.company=b.company(+)
and  a.hours_actual_hpd&lt;> nvl (b.hours_paytran,0)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 2" id="2716ce76-81c7-4796-9c5e-64c1d3f8f653"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from  mb18.alesco_pepaytran_clean where emplid= '0820546' and workdate='22/may/2011' and job_no='01' and paycode='STDHR'</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 3" id="495e11d6-cc4b-4954-803b-24b251c9c207"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from  mb18.alesco_ppm_days_paid_clean where emplid= '0820546'</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 4" id="c55f4fe4-d66a-4b6d-ad38-e675fdd393c3"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from  mb18.alesco_actual_hpd_clean where emplid= '0820546' and workdate='22/may/2011'  and paycode='STDHR' and job_no='01'</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="a4c6e3ae-18b1-428c-9f3e-02b84ef081f6" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST3  everything from PPM got into actual hpd for emp" searchProperties="true" timeout="0"><con:description>correct orig emplid - if any more oddball characters get into the PPM database this test will fail, find and remove in sql </con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="7bb3b43d-5f3d-4f38-a53b-e4dd1b188e92"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select a.emplid, a.expected_pay_end_date, a.ppm_hpd_clean, b.ppm_raw
from
 (select emplid, expected_pay_end_date, ppm_days_paid ppm_hpd_clean from mb18.alesco_actual_hpd_clean where paycode='PPM' ) a
,(select emplid, expected_pay_end, ppm_days_paid ppm_raw from mb18.ALESCO_PPM_DAYS_PAID_CLEAN ) b
where a.emplid=b.emplid(+) and a.expected_pay_end_date=b.expected_pay_end(+)
and ppm_hpd_clean&lt;> nvl (b.ppm_raw,0)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="acfeeeb8-fc66-4128-9cbb-a369e7660ba0" discardOkResults="true" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST 4  everything for WKs from paytran not PPM got into actual_hpd" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query - 1" id="5a637f42-3060-444f-b06c-90e4b95937b7"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select x.* , y.hours_act_hpd
from

(--Pepaytran and not ppm, start of X  
select
a.emplid, a.job_no, a.paycode, a.expected_pay_end_date, a.paytran_hours
from
(select emplid, job_no, paycode, expected_pay_end_date, sum (hours) paytran_hours from mb18.alesco_pepaytran_clean where delete_reason is null 
    group by emplid, job_no, paycode, expected_pay_end_date
    ) a
,(select emplid,  expected_pay_end, ppm_days_paid ppm_raw from mb18.ALESCO_PPM_DAYS_PAID_CLEAN where ppm_days_paid&lt;>0 ) b
where a.emplid=b.emplid(+) and a.expected_pay_end_date=b.expected_pay_end(+)
and b.expected_pay_end is null
) x -- end of pepaytran X 

,(select emplid, job_no, paycode,  expected_pay_end_date , sum (hours) hours_act_hpd from mb18.alesco_actual_hpd_clean where rdp_source='ALESCO_PEPAYTRAN_CLEAN'
    group by emplid, job_no, paycode, expected_pay_end_date) y

where 
x.emplid=y.emplid(+) and x.job_no=y.job_no(+) and x.paycode=y.paycode(+)  and x.expected_pay_end_date=y.expected_pay_end_date(+)
and x.paytran_hours &lt;> nvl(y.hours_act_hpd,0)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 2" id="eb90e95a-511e-484e-bf74-76dc88c71d05"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from mb18.alesco_pepaytran_clean where emplid='0829563' and workdate='7/may/2011' and delete_reason is null</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 3" id="6d936ee8-1438-48b0-bc77-5b8f4edf134c"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from mb18.alesco_ppm_days_paid_clean where emplid='0829563' and expected_pay_end>='7/may/2011' order by expected_pay_end</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 4" id="e95b9e28-5f21-4c5f-b2a5-e2279f9d4e0e"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from mb18.alesco_actual_hpd_clean where emplid='0829563' and  expected_pay_end_date='7/may/2011' order by expected_pay_end_date</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="bf372a2e-b04e-45ff-9a7a-3b12bcaab3eb" discardOkResults="true" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST 5  everything for MSs from paytran into actual_hpd" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>zero rows equals pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query - 1" id="01691be5-7ef2-4ec1-ab25-2a1cbeaedb70"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select x.emplid, x.job_no, x.workdate,x.paycode, x.pay_end_paytran, x.paytran_hours , y.hours_act_hpd
from
(--Pepaytran and not ppm, start of X  
select a.emplid, a.job_no, a.paycode, a.workdate, a.expected_pay_end_date pay_end_paytran, sum (a.hours) paytran_hours 
from mb18.alesco_pepaytran_clean a, mb18_ods_alesco.ah_occupancy  occ, mb18.HR_FTE_GRADE_MAPPINGS gm
 where a.delete_reason is null 
and a.emplid=occ.employee_no and a.job_no=occ.job_no and a.workdate between occ.portion_start and portion_end and occ.classification=gm.grade
and gm.MS_CEA='MS'
--and paygroup='FN' -- was this

    group by a.emplid, a.job_no, a.paycode, a.expected_pay_end_date ,a.workdate
) x

,(select hpd.emplid, hpd.job_no, hpd.paycode, hpd.expected_pay_end_Date, hpd.workdate , sum (hpd.hours) hours_act_hpd from mb18.alesco_actual_hpd_clean  hpd , mb18_ods_alesco.ah_occupancy  occ, mb18.HR_FTE_GRADE_MAPPINGS gm
where hpd.rdp_source='ALESCO_PEPAYTRAN_CLEAN' 
and hpd.emplid=occ.employee_no and hpd.job_no=occ.job_no and hpd.workdate between occ.portion_start and portion_end and occ.classification=gm.grade
and gm.MS_CEA='MS'
--and paygroup='FN' -- was this
    group by hpd.emplid, hpd.job_no, hpd.paycode, hpd.expected_pay_end_Date, hpd.workdate) y

where 
x.emplid=y.emplid(+) and x.job_no=y.job_no(+) and x.paycode=y.paycode(+) and x.pay_end_paytran=y.expected_pay_end_Date(+) and x.workdate=y.workdate(+)
and x.paytran_hours &lt;> nvl(y.hours_act_hpd,0)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 2" id="284a0b0d-9b07-43b5-a6e5-6869a71c97b6"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from mb18.alesco_pepaytran_clean where emplid='0835360' and expected_pay_end_date='8/oct/2011' and job_no='01'</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Database Query - 3" id="bc5b2874-7564-45f8-a1aa-7f90c0103316"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from mb18.alesco_actual_hpd_clean where emplid='0835360' and expected_pay_end_date='8/oct/2011' and job_no='01'</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="dba55e06-3b46-4031-a775-e75e4e1856c3" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 6  everything for MSs from paytran into actual_hpd" searchProperties="true" timeout="0"><con:description>rostered hpd clean is the fake pepaytran for FNs</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="5917e9ee-400e-4bda-b485-571999992968"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>with x as 
(select a.emplid, a.job_no, nvl(paycode,'STDHR') paycode,  a.workdate, sum(nvl (b.hours,a.hours_paid_for_day)) hours_paid_for_day 
from mb18.alesco_rostered_hpd_clean a  ,mb18.ALESCO_PEPAYTRAN_CLEAN b, mb18_ods_alesco.ah_occupancy  occ, mb18.HR_FTE_GRADE_MAPPINGS gm
    where 1=1
    and b.delete_reason is null 
    and a.emplid=b.emplid(+) and a.job_no=b.job_no(+) and a.workdate=b.workdate(+) --and 'STDHR'=b.paycode(+)
    and a.emplid=occ.employee_no and a.job_no=occ.job_no and a.workdate between occ.portion_start and occ.portion_end 
    and occ.classification=gm.grade and gm.MS_CEA='MS'
    and a.casual_roster_yn='N' --and a.paygroup='FN' WAS this, now MS above 
    and a.hours_paid_for_day&lt;>0
    and a.workdate&lt;= trunc (sysdate)
    and a.workdate>='24/apr/2011'
--and a.emplid='0817814'  
---and a.workdate='1/apr/2011'
    group by a.emplid, a.job_no, paycode,  a.workdate
    ) 

,y as (select a.emplid, a.job_no, a.paycode, a.workdate , sum (a.hours) hours_act_hpd from mb18.alesco_actual_hpd_clean a
, mb18_ods_alesco.ah_occupancy  occ, mb18.HR_FTE_GRADE_MAPPINGS gm 
where 1=1 --and mb18_source&lt;>'mb18.ALESCO_PEPAYTRAN_CLEAN' 
    and a.emplid=occ.employee_no and a.job_no=occ.job_no and a.workdate between occ.portion_start and occ.portion_end 
    and occ.classification=gm.grade and gm.MS_CEA='MS'
    and a.workdate&lt;= trunc (sysdate)
--and emplid='0817814'  
--and workdate='23/nov/2012'
    group by a.emplid, a.job_no, a.paycode,  a.workdate
    )

select x.emplid, x.job_no, x.workdate,x.paycode,  x.hours_paid_for_day , y.hours_act_hpd
from x,y
where 
x.emplid=y.emplid(+) and x.job_no=y.job_no(+) and x.paycode=y.paycode(+) and x.workdate=y.workdate(+)
and x.hours_paid_for_day &lt;> nvl(y.hours_act_hpd,0)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="462daf14-51d0-4112-8c8d-e51e09fdc7ed" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 7 FN paytran clean eg overtime got into actual_hpd" searchProperties="true" timeout="0"><con:description>not quite sure if this is a valid test, of rows appear needs checking out but could be ok
No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="183d70f5-eaf3-4c24-ba89-b2c3bf524d80"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select x.* , y.hours_act_hpd
from
-- rostered hpd clean is the fake pepaytran for FNs 
(select a.emplid, a.job_no, paycode ,  a.workdate, sum(hours) hours_paytran from mb18.alesco_pepaytran_clean a where paygp='FN' and delete_reason is null
    and workdate&lt;= trunc (sysdate)
    group by a.emplid, a.job_no,  paycode ,  a.workdate
    ) x

,(select emplid, job_no, paycode, workdate , sum (hours) hours_act_hpd from mb18.alesco_actual_hpd_clean where paygroup='FN' --and mb18_source='mb18.ALESCO_PEPAYTRAN_CLEAN' 
    and workdate&lt;= trunc (sysdate)
    group by emplid, job_no, paycode,  workdate
    ) y
where 
x.emplid=y.emplid(+) and x.job_no=y.job_no(+) and x.paycode=y.paycode(+) and x.workdate=y.workdate(+)
and x.hours_paytran &lt;> nvl(y.hours_act_hpd,0)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="367e6948-8f04-49e4-ab30-783512891a39" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 8a check only one source per expected ppe" searchProperties="true" timeout="0"><con:description>No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="daab2e94-29d6-4791-87ee-a94476af9140"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select a.emplid, a.expected_pay_end_date, count(*) from 
(select distinct emplid, expected_pay_end_date from mb18.alesco_actual_hpd_clean where rdp_source='mb18.ALESCO_PPM_DAYS_PAID_CLEAN') a
,(select distinct emplid, expected_pay_end_date from mb18.alesco_actual_hpd_clean where rdp_source&lt;>'mb18.ALESCO_PPM_DAYS_PAID_CLEAN') b
where a.emplid=b.emplid(+) and a.EXPECTED_PAY_END_DATE=b.EXPECTED_PAY_END_DATE(+)
group by a.emplid , a.expected_pay_end_date
having count(*)>1</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="ed8bd43d-8c08-413b-8189-5d9d47df5400" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 8b check only one source per expected ppe reverse" searchProperties="true" timeout="0"><con:description>No rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="c01fca39-e5c0-4553-b157-1225787d13ea"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select b.emplid, b.expected_pay_end_date, count(*) from 
(select distinct emplid, expected_pay_end_date from mb18.alesco_actual_hpd_clean where rdp_source='mb18.ALESCO_PPM_DAYS_PAID_CLEAN') a
,(select distinct emplid, expected_pay_end_date from mb18.alesco_actual_hpd_clean where rdp_source&lt;>'mb18.ALESCO_PPM_DAYS_PAID_CLEAN') b
where b.emplid=a.emplid(+) and b.EXPECTED_PAY_END_DATE=a.EXPECTED_PAY_END_DATE(+)
group by b.emplid , b.expected_pay_end_date
having count(*)>1</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="87cfc02a-2cef-4abf-8ea7-0ebf4a39a9e3" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 8c check only one source per expected ppe" searchProperties="true" timeout="0"><con:description>no rows is pass.  
No idea why C846 comes up but manually checked not sure if this is a valid test to run but leaving in case it is as it was hard work!</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="e08acf31-2bcb-4975-b0ec-742d2488dd4a"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select a.emplid, a.expected_pay_end_date, count(*) from 
(select distinct emplid, expected_pay_end_date,rdp_source from mb18.alesco_actual_hpd_clean where rdp_source&lt;>'ALESCO_PPM_DAYS_PAID_CLEAN' and paygroup='WK') a where a.emplid not in ('0831356', '182366')   -- JW ignore these 2 emplids
group by a.emplid , a.expected_pay_end_date
having count(*)>1</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="4b460771-5814-4f67-b659-00e778f1cf5b" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 9 not run as yet check rdp source is ok (try for FNs)" searchProperties="true" timeout="0"><con:description>no rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="d217adbd-3dc7-4274-ba67-36c010fe7eb2"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select * from mb18.ALESCO_ACTUAL_HPD_CLEAN where paygroup='WK' and rdp_source='mb18.ALESCO_ACTUAL_HPD_CLEAN'</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="b1962515-b333-482e-9f86-db7eb79643de" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST10 PPM paygroup" searchProperties="true" timeout="0"><con:description>no rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="036d7cbd-a1c6-4fbc-ab63-ae619ba8b51e"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select *  from mb18.ALESCO_ACTUAL_HPD_CLEAN where job_no='PP' and paygroup&lt;> 'WK'</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="06da0311-0301-49a0-ab21-1677d8c1d557" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST11 MSCEA" searchProperties="true" timeout="0"><con:description>no rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="6efe2434-5225-40be-a2bd-acc2be9a7dc0"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select a.emplid, b.classification, a.paygroup, a.ms_cea ms_cea_from_aahpdc, c.grade, c.ms_cea  ms_cea_from_mappings  
from mb18.ALESCO_ACTUAL_HPD_CLEAN a, mb18.alesco_occupancy_clean b, mb18.hr_fte_grade_mappings c
where a.emplid=b.emplid and a.job_no=b.job_no and a.workdate between effdt_start and effdt_end and b.classification=C.grade
and a.ms_cea&lt;>c.ms_ce</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:properties/><con:reportParameters/></con:testSuite><con:testSuite id="ca5b7060-bd06-4024-824e-f445765f591e" name="4020-110 ALESCO_ABSENCES_CLEAN aab xxxx"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:runType>SEQUENTIAL</con:runType><con:testCase id="c84fb96e-01da-45eb-8755-ef01a81b5220" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST 1 - No leave with INCLUDE_ABSENCE_YN = N (exc SPD), no lv_amt = 0" searchProperties="true" timeout="3600000" maxResults="500" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>No rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query - 1" id="45bd6f60-34ec-4833-809e-783fd3c1fa5d"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT count(*) FROM mb18.alesco_absences_clean WHERE ((LV_CODE,LV_REASON) in (select ABSENCE_CODE,ABSENCE_REASON from mb18.ABSENCES_TBL where SOURCE = 'ALESCO' and INCLUDE_ABSENCE_YN = 'N') AND LV_CODE &lt;> 'SPD') OR lv_amt = 0</con:query><con:assertion type="XPath Match" id="56cca88f-26fd-41c0-bfeb-8be9f2530d19" name="Fails if the COUNT of rows is not 0"><con:configuration><path>//Results[1]/ResultSet[1]/Row[1]/COUNT[1]/text()</path><content>0</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="88024d96-c5b7-4b9c-888c-9523db6f4129" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 2 - No reversal_date &lt;= start_date and no reversal_date = entry_date" searchProperties="true" timeout="0"><con:description>No rows = Pass;</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query - 1" id="b7742cff-9105-49b9-9c01-b9e54443ba44"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT * FROM mb18.alesco_absences_clean WHERE (reversal_date &lt;= start_date OR reversal_date = entry_date)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="cc35af29-de71-4e42-ae10-56abfeb0260b" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 3 - duration_days and duration_hours calculation for rows with lv_unit = 'D'" searchProperties="true" timeout="0"><con:description/><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="975787cf-c42a-46d6-9d1c-c4676e4c4e01"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT * FROM mb18.alesco_absences_clean WHERE lv_unit = 'D' AND lv_amt &lt;> duration_days
UNION ALL
SELECT * 
FROM 
mb18.alesco_absences_clean abs
WHERE 
lv_unit = 'D' 
AND lv_amt &lt; 1 
AND mod(lv_amt,1) &lt;> 0
AND duration_hours &lt;> lv_amt * (SELECT
                        sum(HOURS_PER_DAY)
                        FROM
                        mb18.alesco_rostered_hpd_clean ros
                        WHERE
                        ros.emplid = abs.emplid
                        AND ros.job_no = abs.job_no
                        AND workdate BETWEEN abs.start_date AND abs.end_date
                        ) 
UNION ALL
SELECT * 
FROM
mb18.alesco_absences_clean abs
WHERE
lv_unit = 'D'
AND lv_amt >= 1
AND duration_hours &lt;> (SELECT
                        sum(HOURS_PER_DAY)
                        FROM
                        mb18.alesco_rostered_hpd_clean ros
                        WHERE
                        ros.emplid = abs.emplid
                        AND ros.job_no = abs.job_no
                        AND workdate BETWEEN abs.start_date AND abs.end_date
                        AND (pbhol_units IS NULL OR pbhol_units = 0)
                        )</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="1b4e9a98-9c62-4a5b-901e-d2ea1aa31507" discardOkResults="true" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST 4 - duration_days and duration_hours calculation for rows with lv_unit = 'H'" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query - 1" id="f8cd759b-4e5a-43ef-8589-49cae807b919"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT * FROM mb18.alesco_absences_clean WHERE lv_unit = 'H' AND lv_amt &lt;> duration_hours
UNION
SELECT * 
FROM
mb18.alesco_absences_clean abs
WHERE
lv_unit = 'H'
AND duration_days &lt;> (SELECT
                        count(*)
                        FROM
                        mb18.alesco_rostered_hpd_clean ros
                        WHERE
                        ros.emplid = abs.emplid
                        AND ros.job_no = abs.job_no
                        AND workdate BETWEEN abs.start_date AND abs.end_date
                        AND hours_per_day &lt;> 0 
                        AND (pbhol_units IS NULL OR pbhol_units = 0)
                        )</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="0085428c-8582-47cb-9401-805d2a162870" discardOkResults="true" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST 5 - duplicate_ind for rows with reversal_date" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>zero rows equals pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="68ed7870-b5d4-4aa4-bf2b-0d35820003b5"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT * FROM mb18.alesco_absences_clean WHERE reversal_date is not null AND duplicate_ind &lt;> 'R'</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="5b95f9b2-4de4-4352-87e8-7d250e587651" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 6a - Differences between LV_BOOKINGS with filters and ALESCO_ABSENCES_CLEAN" searchProperties="true" timeout="0"><con:description>rostered hpd clean is the fake pepaytran for FNs</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="020673c5-86de-46d8-960b-c0b01e6c9d0e"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT
*
FROM 
(
SELECT
distinct *
FROM
mb18_ods_alesco.LV_BOOKINGS
WHERE
((LV_CODE,decode(lv_reason,null,'&lt;null>',lv_reason)) in (select ABSENCE_CODE,ABSENCE_REASON from mb18.ABSENCES_TBL where SOURCE = 'ALESCO' and INCLUDE_ABSENCE_YN = 'Y') OR lv_code = 'SPD')
AND lv_amt &lt;> 0
AND (reversal_date IS NULL OR (reversal_date &lt;> entry_date AND reversal_date > start_date))
) a
,(SELECT * FROM mb18.ALESCO_ABSENCES_CLEAN) b
WHERE
a.employee# = b.emplid (+)
AND a.job# = b.job_no (+)
AND a.lv_code = b.lv_code (+)
AND a.start_date = b.start_date (+)
AND a.lv_amt = b.lv_amt (+)
AND b.emplid is null</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="33f60963-c327-4e1b-8a20-05a54d67a39e" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 6b - Differences between LV_BOOKINGS with filters and ALESCO_ABSENCES_CLEAN" searchProperties="true" timeout="0"><con:description>not quite sure if this is a valid test, of rows appear needs checking out but could be ok
No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="b5ddfd1a-fb08-4133-9867-fcf71890b23c"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT
*
FROM 
(
SELECT
distinct *
FROM
mb18_ods_alesco.LV_BOOKINGS
WHERE
((LV_CODE,decode(lv_reason,null,'&lt;null>',lv_reason)) in (select ABSENCE_CODE,ABSENCE_REASON from mb18.ABSENCES_TBL where SOURCE = 'ALESCO' and INCLUDE_ABSENCE_YN = 'Y') OR lv_code = 'SPD')
AND lv_amt &lt;> 0
AND (reversal_date IS NULL OR (reversal_date &lt;> entry_date AND reversal_date > start_date))
) a
,(SELECT * FROM mb18.ALESCO_ABSENCES_CLEAN) b
WHERE
b.emplid = a.employee# (+)
AND b.job_no = a.job# (+)
AND b.lv_code = a.lv_code (+)
AND b.start_date = a.start_date (+)
AND b.lv_amt = a.lv_amt (+)
AND a.employee# is null</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="3887f8b0-6a92-4fc4-8ab0-2c48f58c8a23" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 7a - Only unique rows" searchProperties="true" timeout="0"><con:description>No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="8bf3c52e-2cef-4a6e-88cd-d9bc5608883d"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT
*
FROM
(SELECT * FROM mb18.ALESCO_ABSENCES_CLEAN) a
,(SELECT DISTINCT * FROM mb18.ALESCO_ABSENCES_CLEAN) b
WHERE
a.emplid = b.emplid (+)
AND a.job_no = b.job_no (+)
AND b.emplid is null</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="e6997b36-3580-4562-a4cc-661b6448e604" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 7b - Only unique rows" searchProperties="true" timeout="0"><con:description>No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="05f5b28c-c163-4f98-a6af-829a0a54d652"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT
*
FROM
(SELECT * FROM mb18.ALESCO_ABSENCES_CLEAN) a
,(SELECT DISTINCT * FROM mb18.ALESCO_ABSENCES_CLEAN) b
WHERE
b.emplid = a.emplid (+)
AND b.job_no = a.job_no (+)
AND a.emplid is null</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="0e7176f6-ed3f-409b-a258-3e5e8d10efb2" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 8 - LV_REASON updated to '&lt;null>' when it is null" searchProperties="true" timeout="0"><con:description>No rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="166f755c-329e-4836-bfea-6f0f89a7961d"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT count(*) FROM mb18.alesco_absences_clean WHERE lv_reason IS NULL</con:query><con:assertion type="XPath Match" name="Fails if the COUNT of rows is not 0" id="4dfcb0fe-e441-44d3-a291-c9f88176d163"><con:configuration><path>//Results[1]/ResultSet[1]/Row[1]/COUNT[1]/text()</path><content>0</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="c2668009-1e05-4b5e-8ead-38e1dab5d39c" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 9 - Differences in LV_AMT between LV_BOOKINGS and ALESCO_ABSENCES_CLEAN" searchProperties="true" timeout="0"><con:description>no rows is pass.  
No idea why C846 comes up but manually checked not sure if this is a valid test to run but leaving in case it is as it was hard work!</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="0b38dc01-94d6-4f47-b422-5e3c6744451e"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query><![CDATA[SELECT 
employee#,job#,a.lv_code,a.start_date 
FROM
(SELECT 
employee#
,job#
,lv_code
,start_date
,sum(case
        when lv_unit = 'H'
            then lv_amt
     end       
     ) hours1
,sum(case
        when lv_unit = 'D'
            then lv_amt
     end       
     ) days1
FROM 
mb18_ods_alesco.lv_bookings 
WHERE
((LV_CODE,decode(lv_reason,null,'<null>',lv_reason)) in (select ABSENCE_CODE,ABSENCE_REASON from mb18.ABSENCES_TBL where SOURCE = 'ALESCO' and INCLUDE_ABSENCE_YN = 'Y') OR lv_code = 'SPD')
AND lv_amt <> 0
AND (reversal_date IS NULL OR (reversal_date <> entry_date AND reversal_date > start_date))
and end_date<='01-may-2014'
GROUP BY employee#,job#,lv_code,start_date) a
,(SELECT 
emplid
,job_no
,lv_code
,start_date
,sum(case
        when lv_unit = 'H'
            then lv_amt
     end       
     ) hours2
,sum(case
        when lv_unit = 'D'
            then lv_amt
     end       
     ) days2
FROM 
mb18.alesco_absences_clean
GROUP BY emplid,job_no,lv_code,start_Date) b
WHERE
a.employee# = b.emplid (+)
AND a.job# = b.job_no (+)
AND a.lv_code = b.lv_code (+)
AND a.start_date = b.start_date (+)
AND (abs(hours1 - nvl(hours2,0)) > 0.1 OR abs(days1 - nvl(days2,0)) > 0.1)
MINUS
SELECT
employee#,job#,lv_code,start_date
FROM
mb18_ods_alesco.lv_bookings
WHERE 
(employee#,job#,lv_code,start_date)
IN
(SELECT
employee#,job#,lv_code,start_date
FROM
mb18_ods_alesco.lv_bookings
WHERE
((LV_CODE,decode(lv_reason,null,'<null>',lv_reason)) in (select ABSENCE_CODE,ABSENCE_REASON from mb18.ABSENCES_TBL where SOURCE = 'ALESCO' and INCLUDE_ABSENCE_YN = 'Y') OR lv_code = 'SPD')
AND lv_amt <> 0
and end_date<='01-may-2014'
AND (reversal_date IS NULL OR (reversal_date <> entry_date AND reversal_date > start_date))
GROUP BY BOOKING_ID, EMPLOYEE#, ORIGINAL_EMPLOYEE#, JOB#, LV_CODE, START_DATE, END_DATE, RESUMPTION_DATE, LV_AMT, LV_UNIT, LV_PERCENT, SAL_AMT, SAL_PERCENT, LOAD_PERCENT, ENTRY_DATE, CONFIRM_DATE, REVERSAL_DATE, PAYROLL_DATE, ADV_PAY, MED_CERT, DOCUMENT, BATCH_NO, EMP_STATUS, TP, TP_TIME, TP_TYPE, USERID, COMMENTS, AUDIT_DATE, AUDIT_ID, POSITION#, REFERENCE, LV_REASON, POS_FRACTION, NOMINATED_AMT, OVER_POS_FRACTION, HRS_FRACTION, APPLY_POS_FRAC, WCOMP, CLAIM#, GRACE_FLAG, LV_AMT_DAYS, DOCTOR, CERTIFICATE_NO, SURGERY_ADD1, SURGERY_ADD2, CERT_ISSUE_DATE, CERT_VALID_FROM, CERT_VALID_TO, EXTENDED_LV, DATE_COSTED_TO, DATE_REVERSAL_COSTED_TO, M_CERT_DOC_NAME, ACCIDENT#, INJURY#
HAVING count(*) > 1
)]]></con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:properties/><con:reportParameters/></con:testSuite><con:testSuite id="35566832-504a-420d-b988-e61c0322e741" name="4020-120 ALESCO_PAYSLIPS_CLEAN_1 apy"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:runType>SEQUENTIAL</con:runType><con:testCase id="fb9bc21e-bc94-46c7-b1d0-ced06cc7997e" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST 1 - No rows with AMT = 0 or AMT null for non-absence paycodes" searchProperties="true" timeout="3600000" maxResults="500" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>No rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query - 1" id="e4cc1eb6-941f-4914-8b74-a598f98e4c49"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT * FROM mb18.alesco_payslips_clean_1 WHERE PAYCODE not in (select distinct(PAYCODE_USED_TO_PAY) from mb18.ABSENCES_TBL where SOURCE = 'ALESCO') AND (amt = 0 OR amt IS NULL)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="a8ce824d-6727-4417-87f7-132e6488edf6"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="4b777d5d-92ec-4e93-a898-579339952e75" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 2a - Differences between ALESCO_PEHISTPAY_CLEAN with filters and ALESCO_PAYSLIPS_CLEAN_1" searchProperties="true" timeout="0"><con:description>No rows = Pass;</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query - 1" id="ddbfb36a-8a68-4ec6-a3bb-fc65c0d04b79"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT   emplid, job_no, paygroup, start_date, period_end_date, paycode, 
         company, SUM (amt)
    FROM (SELECT a.*, b.company_code company
            FROM mb18.alesco_pehistpay_clean a, mb18_ods_alesco.job b
           WHERE a.emplid = b.employee# and a.job_no = b.job#
             AND CASE
                    WHEN company_code = 'RML'
                    AND a.period_end_date > '01-JAN-2014'
                       THEN 'out'
                    ELSE 'in'
                 END = 'in')
   WHERE (paycode NOT IN (SELECT DISTINCT (paycode_used_to_pay)
                                     FROM mb18.absences_tbl
                                    WHERE SOURCE = 'ALESCO') AND amt &lt;> 0
         )
      OR paycode IN (SELECT DISTINCT (paycode_used_to_pay)
                                FROM mb18.absences_tbl
                               WHERE SOURCE = 'ALESCO')
      
GROUP BY emplid,
         job_no,
         paygroup,
         start_date,
         period_end_date,
         paycode,
         company
MINUS
SELECT   emplid, job_no, paygroup, start_date, period_end_date, paycode,
         company, SUM (amt)
    FROM mb18.alesco_payslips_clean_1
GROUP BY emplid,
         job_no,
         paygroup,
         start_date,
         period_end_date,
         paycode,
         company</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="c0689688-9392-454c-a42a-c8881a72bd45" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 2b - Differences between ALESCO_PEHISTPAY_CLEAN with filters and ALESCO_PAYSLIPS_CLEAN_1" searchProperties="true" timeout="0"><con:description>no rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="4fd1fe81-7613-4580-bb04-e461b08685ba"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT   emplid, job_no, paygroup, start_date, period_end_date, paycode,
         company, SUM (amt)
    FROM mb18.alesco_payslips_clean_1
GROUP BY emplid,
         job_no,
         paygroup,
         start_date,
         period_end_date,
         paycode,
         company
MINUS
SELECT   emplid, job_no, paygroup, start_date, period_end_date, paycode,
         company, SUM (amt)
    FROM (SELECT a.*, b.company_code company
            FROM mb18.alesco_pehistpay_clean a, mb18_ods_alesco.job b
           WHERE a.emplid = b.employee#
             AND a.job_no = b.job#
             AND CASE
                    WHEN company_code = 'RML'
                    AND a.period_end_date > '01-JAN-2014'
                       THEN 'out'
                    ELSE 'in'
                 END = 'in')
   WHERE (paycode NOT IN (SELECT DISTINCT (paycode_used_to_pay)
                                     FROM mb18.absences_tbl
                                    WHERE SOURCE = 'ALESCO') AND amt &lt;> 0
         )
      OR paycode IN (SELECT DISTINCT (paycode_used_to_pay)
                                FROM mb18.absences_tbl
                               WHERE SOURCE = 'ALESCO')
GROUP BY emplid,
         job_no,
         paygroup,
         start_date,
         period_end_date,
         paycode,
         company</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="a536bc31-6f8e-47c9-9cac-40f5ded1a9a8" discardOkResults="true" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST 3 - period_start_date calculation" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query - 1" id="d1fec1ee-ddc5-40a0-9431-2cb7938bd63f"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT * FROM mb18.alesco_payslips_clean_1 WHERE period_start_date is null
UNION ALL
SELECT
pay.*
FROM
mb18.alesco_payslips_clean_1 pay
,mb18.pay_periods cal
WHERE
cal.source = 'ALESCO'
AND cal.company = pay.company
AND cal.paygroup = pay.paygroup
AND cal.pay_period_end_date = pay.period_end_date
AND cal.pay_period_start_date &lt;> pay.period_start_date</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="7abddfd1-ddfd-480c-bf25-6ce13a82610a" discardOkResults="true" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST 4a - identical_ind calculation" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>zero rows equals pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="2f43681e-3ec9-41ba-a17d-d010c6bd6b85"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT   emplid, original_emplid, job_no, company, paygroup, payperno,
         payperyr, peruntl, peruntlyr, payrun, period_start_date,
         period_end_date, paydate, paytype, paycode, unit, payrate, amt,
         compamt, duty_type, award, classification, step, paymethod,
         history_type, start_date, end_date, workdays, payfreq, payroll_date,
         disb_date, gl_date, gpserial, gl_override, adjust_date, origin,
         roster, comments, SOURCE, process, batch#, wcomp, ir_process,
         job_cost_code, lspe_flag, extra_pc, one_off_flag, actual_duty,
         gl_duty_type, source_paycode, nz_retro_tax, swift, swift_amt,
         c_factor, username, etp_type, original_paycode, identical_ind,
         group_ind
    FROM mb18.alesco_payslips_clean_1
   WHERE identical_ind = 'N'
GROUP BY emplid,
         original_emplid,
         job_no,
         company,
         paygroup,
         payperno,
         payperyr,
         peruntl,
         peruntlyr,
         payrun,
         period_start_date,
         period_end_date,
         paydate,
         paytype,
         paycode,
         unit,
         payrate,
         amt,
         compamt,
         duty_type,
         award,
         classification,
         step,
         paymethod,
         history_type,
         start_date,
         end_date,
         workdays,
         payfreq,
         payroll_date,
         disb_date,
         gl_date,
         gpserial,
         gl_override,
         adjust_date,
         origin,
         roster,
         comments,
         SOURCE,
         process,
         batch#,
         wcomp,
         ir_process,
         job_cost_code,
         lspe_flag,
         extra_pc,
         one_off_flag,
         actual_duty,
         gl_duty_type,
         source_paycode,
         nz_retro_tax,
         swift,
         swift_amt,
         c_factor,
         username,
         etp_type,
         original_paycode,
         identical_ind,
         group_ind
  HAVING COUNT (*) > 1</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="96b00a0d-9e8e-445f-9726-b7c3d963ec38" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 4b - identical_ind calculation" searchProperties="true" timeout="0"><con:description>rostered hpd clean is the fake pepaytran for FNs</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="06500816-62c6-49a1-8372-a59b185e9c3d"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT   emplid, original_emplid, job_no, company, paygroup, payperno,
         payperyr, peruntl, peruntlyr, payrun, period_start_date,
         period_end_date, paydate, paytype, paycode, unit, payrate, amt,
         compamt, duty_type, award, classification, step, paymethod,
         history_type, start_date, end_date, workdays, payfreq, payroll_date,
         disb_date, gl_date, gpserial, gl_override, adjust_date, origin,
         roster, comments, SOURCE, process, batch#, wcomp, ir_process,
         job_cost_code, lspe_flag, extra_pc, one_off_flag, actual_duty,
         gl_duty_type, source_paycode, nz_retro_tax, swift, swift_amt,
         c_factor, username, etp_type, original_paycode, identical_ind,
         group_ind
    FROM mb18.alesco_payslips_clean_1
   WHERE identical_ind = 'Y'
GROUP BY emplid,
         original_emplid,
         job_no,
         company,
         paygroup,
         payperno,
         payperyr,
         peruntl,
         peruntlyr,
         payrun,
         period_start_date,
         period_end_date,
         paydate,
         paytype,
         paycode,
         unit,
         payrate,
         amt,
         compamt,
         duty_type,
         award,
         classification,
         step,
         paymethod,
         history_type,
         start_date,
         end_date,
         workdays,
         payfreq,
         payroll_date,
         disb_date,
         gl_date,
         gpserial,
         gl_override,
         adjust_date,
         origin,
         roster,
         comments,
         SOURCE,
         process,
         batch#,
         wcomp,
         ir_process,
         job_cost_code,
         lspe_flag,
         extra_pc,
         one_off_flag,
         actual_duty,
         gl_duty_type,
         source_paycode,
         nz_retro_tax,
         swift,
         swift_amt,
         c_factor,
         username,
         etp_type,
         original_paycode,
         identical_ind,
         group_ind
  HAVING COUNT (*) = 1</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="fc4a294c-ba8f-4a89-bd3d-09cbdbd4f2b8" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 5 - Company Code" searchProperties="true" timeout="0"><con:description>not quite sure if this is a valid test, of rows appear needs checking out but could be ok
No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="b904388e-0367-4fe8-aa3b-bc593dac46fc"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT * FROM mb18.alesco_payslips_clean_1 pay
,mb18_ods_alesco.job job
WHERE pay.emplid = job.employee# AND pay.job_no = job.job# AND pay.company &lt;> job.company_code</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:properties/><con:reportParameters/></con:testSuite><con:testSuite id="da315b19-6872-4606-966b-f388463ddb3e" name="4020-130 ALESCO_PAYSLIPS_CLEAN apy xxxx"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:runType>SEQUENTIAL</con:runType><con:testCase id="6c82a52d-f73b-4298-9804-74c0ae62309d" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST 1 - No rows with AMT = 0 or AMT null for non-absence paycodes (after grouping ALESCO_PAYSLIPS_CLEAN_1 for IDENTICAL_IND)" searchProperties="true" timeout="3600000" maxResults="500" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>No rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query - 1" id="a2a575ad-542a-4f7f-9774-e62d5eb577f7"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT count(*) FROM mb18.alesco_payslips_clean WHERE PAYCODE not in (select distinct(PAYCODE_USED_TO_PAY) from mb18.ABSENCES_TBL where SOURCE = 'ALESCO') AND (amt = 0 OR amt IS NULL)</con:query><con:assertion type="XPath Match" name="Fails if the COUNT of rows is not 0" id="f241aded-0934-4286-bb78-43a30c1f95df"><con:configuration><path>//Results[1]/ResultSet[1]/Row[1]/COUNT[1]/text()</path><content>0</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="3710a1fa-0553-41e8-9f03-c11c9382baee" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 2 - Rows with ALESCO_PAYSLIPS_CLEAN.GROUP_IND not in (P5,P7) and IDENTICAL_IND = Y are properly merged" searchProperties="true" timeout="0"><con:description>No rows = Pass;</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query - 1" id="1eb478fa-d12c-44b9-b695-8a1a69377b26"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT 
count(*)
FROM
mb18.alesco_payslips_clean
WHERE
group_ind NOT IN ('P5','P7')
AND identical_ind = 'Y'
GROUP BY ALESCO_PAYSLIPS_CLEAN_ID, EMPLID, ORIGINAL_EMPLID, JOB_NO, COMPANY, PAYGROUP, PAYPERNO, PAYPERYR, PERUNTL, PERUNTLYR, PAYRUN, PERIOD_START_DATE, PERIOD_END_DATE, PAYDATE, PAYTYPE, PAYCODE, PAYRATE, COMPAMT, DUTY_TYPE, AWARD, CLASSIFICATION, STEP, PAYMETHOD, HISTORY_TYPE, START_DATE, END_DATE, WORKDAYS, PAYFREQ, PAYROLL_DATE, DISB_DATE, GL_DATE, GPSERIAL, GL_OVERRIDE, ADJUST_DATE, ORIGIN, ROSTER, COMMENTS, SOURCE, PROCESS, BATCH#, WCOMP, IR_PROCESS, JOB_COST_CODE, LSPE_FLAG, EXTRA_PC, ONE_OFF_FLAG, ACTUAL_DUTY, GL_DUTY_TYPE, SOURCE_PAYCODE, NZ_RETRO_TAX, SWIFT, SWIFT_AMT, C_FACTOR, USERNAME, ETP_TYPE, ORIGINAL_PAYCODE, IDENTICAL_IND, GROUP_IND
HAVING count(*) > 1</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="9e9eca53-7d82-4706-91c9-72b653b73cc4" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 3 - group_ind calculation" searchProperties="true" timeout="0"><con:description>no rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="0bb58199-a1bf-4833-81f0-24efd8b0ff77"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query><![CDATA[SELECT * FROM mb18.alesco_payslips_clean WHERE paycode NOT IN (SELECT distinct(paycode_used_to_pay) FROM mb18.absences_tbl WHERE source = 'ALESCO') AND (comments IS NULL OR comments NOT LIKE '%rounding%') AND group_ind <> 'P1'
UNION ALL
SELECT * FROM mb18.alesco_payslips_clean WHERE paycode IN (select distinct PAYCODE_USED_TO_PAY from mb18.ABSENCES_TBL where SOURCE = 'ALESCO' and INCLUDE_ABSENCE_YN = 'N') AND paycode <> 'LVSPD' AND paycode NOT IN (SELECT distinct(paycode) FROM mb18.paycodes_tbl WHERE source = 'ALESCO' AND type = 'LWOP') AND (comments IS NULL OR comments NOT LIKE '%rounding%') AND group_ind <> 'P2'
UNION ALL
SELECT * FROM mb18.alesco_payslips_clean WHERE paycode IN ('PBHOL','XTHOL') AND (comments IS NULL OR comments NOT LIKE '%rounding%') AND group_ind <> 'P3'
UNION ALL
SELECT * FROM mb18.alesco_payslips_clean WHERE paycode = 'XTLEU' AND (comments IS NULL OR comments NOT LIKE '%rounding%') AND group_ind <> 'P4'
UNION ALL
SELECT * FROM mb18.alesco_payslips_clean WHERE paycode = 'LVSPD' AND (comments IS NULL OR comments NOT LIKE '%rounding%') AND group_ind <> 'P5'
UNION ALL
SELECT * FROM mb18.alesco_payslips_clean WHERE paycode NOT IN (select distinct PAYCODE_USED_TO_PAY from mb18.ABSENCES_TBL where SOURCE = 'ALESCO' and INCLUDE_ABSENCE_YN = 'N') AND paycode IN (SELECT distinct(paycode) FROM mb18.paycodes_tbl WHERE source = 'ALESCO' AND type = 'LWOP') AND (comments IS NULL OR comments NOT LIKE '%rounding%') AND group_ind <> 'P6'
UNION ALL
SELECT * FROM mb18.alesco_payslips_clean WHERE 
paycode IN (SELECT distinct(paycode_used_to_pay) FROM mb18.absences_tbl WHERE source = 'ALESCO' and INCLUDE_ABSENCE_YN = 'Y')
AND paycode NOT IN ('PBHOL','XTHOL','XTLEU','LVSPD') 
AND paycode NOT IN (SELECT distinct(paycode) FROM mb18.paycodes_tbl WHERE source = 'ALESCO' AND type = 'LWOP') 
AND (comments IS NULL OR comments NOT LIKE '%rounding%')
AND group_ind <> 'P7'
UNION ALL
SELECT * FROM mb18.alesco_payslips_clean WHERE comments LIKE '%rounding%' AND group_ind <> 'P8'
UNION ALL
SELECT * FROM mb18.alesco_payslips_clean WHERE group_ind IS NULL
UNION ALL
SELECT * FROM mb18.alesco_payslips_clean WHERE group_ind NOT IN ('P1','P2','P3','P4','P5','P6','P7','P8')]]></con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="9dea974d-c35d-4184-88ea-3c42f719264e" discardOkResults="true" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST 4 - Comparing AMT between PEHISTPAY and ALESCO_PAYSLIPS_CLEAN" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query - 1" id="add265a7-b07a-4645-95e4-f663908a5098"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT
*
FROM
(SELECT
employee# emplid
,job#
,period_end_date
,paycode
,sum(amt) amt1
FROM
mb18_ods_alesco.pehistpay_raw
WHERE
paytype IN ('S','O','A')
AND origin &lt;> 'CNV' and paycode not in ('XTANN', 'RDPBP')  -- JW exclude these paycodes RWinton (Datacom) MB18 project
GROUP BY employee#,job#,period_end_date,paycode) a

,(SELECT
original_emplid emplid
,job_no
,period_end_date
,paycode
,sum(amt) amt2
FROM
mb18.alesco_payslips_clean
GROUP BY original_emplid,job_no,period_end_date,paycode) b

WHERE
a.emplid = b.emplid (+)
AND a.job# = b.job_no (+)
AND a.period_end_date = b.period_end_date (+)
AND a.paycode = b.paycode (+)
AND abs(amt1 - nvl(amt2,0)) > 0.1</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:properties/><con:reportParameters/></con:testSuite><con:testSuite id="cd45f3ab-4270-4a94-a7ee-a8750feb2a78" name="4020-140 ALESCO_PAYSLIPS_ABSENCES_CLEAN apa xxx"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:runType>SEQUENTIAL</con:runType><con:testCase id="69fefcae-ec70-4f42-9ed9-7ca7c7f78c4c" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST 1 - Checking the combo tables (CL_1 to CL_4)" searchProperties="true" timeout="3600000" maxResults="500" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>No rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query - 1" id="7515b2d9-9bae-49dd-9460-4f5199c09013"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT count(*) FROM mb18.alesco_payslips_absences_cl_1 WHERE group_ind NOT IN ('P1','P2','P8') OR link_rule &lt;> 'N'
UNION ALL
--CL_2 is for absence paycodes in scope that don't need a faked absence.
SELECT count(*) FROM mb18.alesco_payslips_absences_cl_2 WHERE group_ind NOT IN ('P3','P4','P5','P7') OR link_rule NOT IN ('R60','R90','R95')
UNION ALL
--CL_3 is for absence paycodes in scope matching with absences after applying rules.
SELECT count(*) FROM mb18.alesco_payslips_absences_cl_3 WHERE group_ind NOT IN ('P5','P7') OR link_rule NOT IN ('R20','R25','R30','R40','R50','R55','R20_N','R30_N','R40_N','R50_N','R55_N')
UNION ALL
--CL4 is for all the payslips with faked absences.
SELECT count(*) FROM mb18.alesco_payslips_absences_cl_4 WHERE group_ind NOT IN ('P3','P4','P5','P7') OR link_rule &lt;> 'F'</con:query><con:assertion type="XPath Match" name="Fails if the COUNT of rows is not 0" id="1e89cd09-0da4-46f2-b57b-598cef2763d9"><con:configuration><path>//Results[1]/ResultSet[1]/Row[1]/COUNT[1]/text()</path><content>0</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="763e2733-e78d-493a-9d79-5a6e33bdde09" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 2 - Rows with Start Date or End Date null" searchProperties="true" timeout="0"><con:description>No rows = Pass;</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query - 1" id="5c230736-d0d8-4f1d-9a18-b43f6ff11924"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT count(*) FROM mb18.alesco_payslips_absences_cl_1 WHERE (start_date IS NULL OR end_date IS NULL)
UNION ALL
SELECT count(*) FROM mb18.alesco_payslips_absences_cl_2 WHERE (start_date IS NULL OR end_date IS NULL)
UNION ALL
SELECT count(*) FROM mb18.alesco_payslips_absences_cl_3 WHERE (start_date IS NULL OR end_date IS NULL)
UNION ALL
SELECT count(*) FROM mb18.alesco_payslips_absences_cl_4 WHERE (start_date IS NULL OR end_date IS NULL)
UNION ALL
SELECT count(*) FROM mb18.alesco_payslips_absences_clean WHERE (start_date IS NULL OR end_date IS NULL)</con:query><con:assertion type="XPath Match" name="Fails if the COUNT of rows is not 0" id="65e2c218-2564-45e0-ba55-4475c044d03d"><con:configuration><path>//Results[1]/ResultSet[1]/Row[1]/COUNT[1]/text()</path><content>0</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="09e2261b-f8d9-4457-99e5-cd9809bd31ab" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 3 - Rows with ABS_PAY_LINK null" searchProperties="true" timeout="0"><con:description>no rows = pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="349abb47-2a39-4594-8c04-c291f65b04fb"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT *
FROM   mb18.ALESCO_PAYSLIPS_ABSENCES_CLEAN
WHERE ( ALESCO_ABSENCES_CLEAN_ID IS NOT NULL OR LINK_RULE = 'F' )
AND    NVL ( FAKE_RULE , 'NULL' ) NOT IN ('RTADJ', 'F2_N' , 'F3_N' , 'F4_N' , 'F5_N')
AND    LINK_RULE NOT IN ('R20_N', 'R30_N', 'R40_N', 'R50_N', 'R55_N')
AND    ABS_PAY_LINK IS NULL</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="be2b0359-5490-408a-ad20-3565670d1832" discardOkResults="true" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST 4 - Check that LV_CODE,LV_REASON,LV_AMT,LV_UNIT are populated for faked absences" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query - 1" id="5aa1c6f7-78e3-4370-b4f6-2a6f455eb3ca"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT count(*) FROM mb18.alesco_payslips_absences_clean WHERE link_rule = 'F' AND (lv_code IS NULL OR lv_reason IS NULL OR lv_amt IS NULL OR lv_unit IS NULL)</con:query><con:assertion type="XPath Match" name="Fails if the COUNT of rows is not 0" id="d1603bdb-d9e1-49dd-bb2e-30c2dd979252"><con:configuration><path>//Results[1]/ResultSet[1]/Row[1]/COUNT[1]/text()</path><content>0</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="9f7f4b51-dbb4-44ca-aa40-149b08c21537" discardOkResults="true" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="TEST 5 - If LINK_COUNT &lt;> '1 to 1' AND LINK_COUNT LIKE '1 to %' then the payslip is split like the absence" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:description>zero rows equals pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="6ce14d44-8186-45dc-8140-b2ce4d542ebe"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT * FROM mb18.alesco_payslips_absences_clean WHERE link_count &lt;> '1 to 1' AND link_count LIKE '1 to %' AND (start_date &lt;> abs_start_date OR end_date &lt;> abs_end_date)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="f369440b-31c1-457a-a0f9-e9ea64d7b6b1" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 6 - If LINK_COUNT &lt;> '1 to 1' AND LINK_COUNT LIKE '% to 1' then the absence is split like the payslip" searchProperties="true" timeout="0"><con:description>rostered hpd clean is the fake pepaytran for FNs</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="bb79ce14-c296-4f64-8e92-c5e4da4e01f9"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>SELECT * FROM mb18.alesco_payslips_absences_clean WHERE link_count &lt;> '1 to 1' AND link_count LIKE '% to 1' AND (start_date &lt;> pay_start_date OR end_date &lt;> pay_end_date)</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="13030755-646e-489f-9171-9ac722bfd2a6" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TEST 7 dollar differences between  payslips_clean and payslips_absences_clean" searchProperties="true" timeout="0"><con:description>not quite sure if this is a valid test, of rows appear needs checking out but could be ok
No rows = Pass</con:description><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="jdbc" name="Database Query" id="638559df-6a44-4487-9ee4-cbaa05bbfc82"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>EDWDVP_MB18</con:dbConnectionName><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/><con:query>select a.*, b.* from
 ( select emplid, period_end_Date, sum (amt)  source_dollars from mb18.alesco_payslips_clean group by emplid, period_end_Date ) a
full outer join
(select emplid, period_end_Date, round(sum (case when amt_paid is null then amt else amt_paid end),2) dest_dollars from mb18.alesco_payslips_absences_clean group by emplid, period_end_Date) b
on a.emplid=b.emplid(+) and a.period_end_Date=b.period_end_Date(+)
where abs((source_dollars-dest_dollars))>0.08</con:query><con:assertion type="Simple NotContains" name="Fails if the response contains any rows (expected 0 rows)" id="e3642c4d-f392-4aef-8bc4-1cbd9c94d309"><con:configuration><token>&lt;/Row></token><ignoreCase>true</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="XPath Match" name="Fails if the COUNT of rows is not 0" id="6e4225ab-67b7-4f76-b96e-782022dab87d"><con:configuration><path>//Results[1]/ResultSet[1]/Row[1]/COUNT[1]/text()</path><content>0</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:properties/><con:reportParameters/></con:testSuite><con:savedRecentRuns>1</con:savedRecentRuns><con:requirements/><con:properties/><con:wssContainer/><con:databaseConnectionContainer><con:databaseConnection><con:name>EDWDVP_MB18</con:name><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/></con:databaseConnection></con:databaseConnectionContainer><con:jmsConnectionContainer/><con:oAuth2ProfileContainer/><con:oAuth1ProfileContainer/><con:reporting><con:xmlTemplates/><con:parameters/></con:reporting><con:eventHandlers type="RequestFilter.filterRequest" name="RequestFilter.filterRequest"><con:script>// Sample event script to add custom HTTP header to all outgoing REST, SOAP and HTTP(S) calls
// This code is often used for adding custom authentication to SoapUI Pro tests

// If hardcoding the token, uncomment and change line 5
// def token = '4567'

// If your token is parameterized in Project level custom property, uncomment line 8
// def token = request.parent.testCase.testSuite.project.getProperty('auth_token').getValue()

// To modify all outgoing calls, remove comments from lines 11 to 16
// def headers = request.requestHeaders
// if (headers.containsKey('auth_token2') == false) {
//   headers.put('auth_token2', token)
//   request.requestHeaders = headers
// }</con:script></con:eventHandlers><con:eventHandlers type="TestRunListener.afterStep" name="TestRunListener.afterStep"><con:script>// Save all test step results into files
// Change the directory path in line 5 to a location where you want to store details
// then uncomment lines 5 to 10

// filePath = 'C:\\tempOutputDirectory\\'
// fos = new FileOutputStream(filePath + testStepResult.testStep.label + '.txt', true)
// pw = new PrintWriter(fos)
// testStepResult.writeTo(pw)
// pw.close()
// fos.close()</con:script></con:eventHandlers><con:environment id="db48fcd7-806a-416c-87b6-7a3a8dd9e94f" name="Dev"><con:databaseConnectionContainer><con:databaseConnection><con:name>EDWDVP_MB18</con:name><con:driver>oracle.jdbc.driver.OracleDriver</con:driver><con:connectionString>jdbc:oracle:thin:MB18_READONLY/PASS_VALUE@DB_DVP_EDW.NZPOST.CO.NZ:1781:EDWDVP</con:connectionString><con:password>r2SL24#1kV5S</con:password><con:connectionProperties/></con:databaseConnection></con:databaseConnectionContainer><con:jmsConnectionContainer/></con:environment><con:authRepository/><con:tags/></con:soapui-project>